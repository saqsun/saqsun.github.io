"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[687],{4687:function(t,e,i){i.r(e),i.d(e,{installAppPluginsCommand:function(){return ls}});i(3439);var s=i(6007),a=i(3257),n=(i(9075),i(5552)),o=i(1223),r=i(6353);const h=()=>{const{innerWidth:t,innerHeight:e}=window;return{width:t,height:e}},l=()=>{var t;return Math.min(null!==(t=window.devicePixelRatio)&&void 0!==t?t:1,2)},d=()=>document.getElementById("game_div"),c=()=>(0,o.Z)().any,_=(new r.UAParser).getResult(),u=t=>t*n.rL,p=t=>t*(1/n.rL),g=t=>{const{x:e,y:i,width:s,height:a}=t;return{x:e+.5*s,y:i+.5*a}},m=t=>Math.random()<=t;i(9218);var y=i(6666),v=i(5457),b=i(2259),w=i(3268),f=i(6155),x=i(2889);class S{constructor(t){(0,y.Z)(this,"_onHapticUpdate",(t=>{t?v.M.enable():v.M.disable()})),this._app=t,b.q.event.on(f.TQ.ballVSlineContact,this._onBallVsLineContact,this).on(f.TQ.ballVSbrickContact,this._onBallVsBrickContact,this).on(f.TQ.ballVSbonusContact,this._onBallVsBonusContact,this).on(f.Is.playClick,this._vibrateButton,this).on(f.a$.homeClick,this._vibrateButton,this).on(f.a$.actionClick,this._vibrateButton,this)}async onInstall(){b.q.event.on(w.ce.hapticUpdate,this._onHapticUpdate,this)}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){}onPause(){}onResume(){}onResize(t,e,i){}_onBallVsLineContact(){v.M.play(v.r.tap,70)}_onBallVsBrickContact(t,e,i){const{playerSet:s}=x.h.game.room,a=s.getFenceById(e).isCastle(i),n=s.player.fence.uuid===e;a?n?v.M.play(v.r.fail,600):v.M.play(v.r.success,800):v.M.play(v.r.beep,100)}_onBallVsBonusContact(){v.M.play(v.r.success,100)}_vibrateButton(){v.M.play(v.r.tap,50)}}i(5735),i(7526),i(3354),i(5870),i(930),i(574),i(4116),i(3267),i(4614),i(9852),i(4306),i(6077),i(1072),i(183),i(6886),i(3108),i(1939);var k=i(9081),C=i(7279),T=i(5310),P=i.n(T),Z=i(2793);class D{constructor(t){(0,y.Z)(this,"_loaders",new Map),(0,y.Z)(this,"_assetsToLoad",0),(0,y.Z)(this,"_assetsLoaded",0),this._app=t}static _getChunkEntryLength(t){return(0,n.XP)(t).reduce(((e,i)=>e+t[i].length),0)}static _getChunkLength(t){return(0,n.XP)(t).reduce(((e,i)=>e+D._getChunkEntryLength(t[i])),0)}async loadChunk(t,e){const i=this._onLoadProgress.bind(this,t);this._assetsLoaded=0,this._assetsToLoad=D._getChunkLength(e),this._onLoadStart(t);const{sounds:s,fonts:a}=e.generic,n=[];(0,C.Z)(s)||n.push(this._loadSounds(s,i)),(0,C.Z)(a)||n.push(this._loadFonts(a,i)),this._loaders.forEach((t=>n.push(t.load(e,i)))),await Promise.all(n),this._onLoadComplete(t)}async onInstall(){}onUninstall(){}onUpdate(t,e){}onPluginInstall(t){switch(t){case s.J0.three:{const e=this._app.plugins[t];if(null==e)return;this._loaders.set(s.J0.three,e.loader)}break;case s.J0.pixi:{const e=this._app.plugins[t];if(null==e)return;this._loaders.set(s.J0.pixi,e.loader)}}}onPluginUninstall(t){}onPause(){}onResume(){}onResize(t,e,i){}_onLoadStart(t){this._app.onLoadStart(t)}_onLoadProgress(t){this._app.onLoadProgress(t,++this._assetsLoaded/this._assetsToLoad)}_onLoadComplete(t){this._app.onLoadComplete(t)}async _loadSounds(t,e){const i=t.map((async t=>await new Promise((i=>new k.Howl({src:Z.L.sounds[t],autoplay:!1,onload:s=>{(async()=>{const s=[];this._loaders.forEach((e=>s.push(e.onGenericAssetLoad("sound",t)))),await Promise.all(s),e(),i()})()}})))));await Promise.all(i)}async _loadFonts(t,e){return await new Promise(((i,s)=>{P().load({custom:{families:t},active:i,inactive:()=>s(new Error("Failed to load fonts")),fontactive:t=>{(async()=>{var i;const s=[];this._loaders.forEach((e=>s.push(e.onGenericAssetLoad("font",t)))),await Promise.all(s),e(),null===(i=document.getElementById(t))||void 0===i||i.remove()})()},fontinactive:t=>{window.console.error("".concat(t," font is not found!"))}})}))}}var M=i(991),B=i(1391),U=i(9218);class R{constructor(t){this._app=t}async setLanguage(t){await M.ZP.changeLanguage(t)}get(t,e){return M.ZP.t(t,e)}async onInstall(){const{fallback:t,supported:e}=U.localization;await M.ZP.use(B.Z).init({compatibilityJSON:"v3",debug:!1,load:"languageOnly",fallbackLng:t,supportedLngs:e,backend:{loadPath:"locales/{{lng}}.json"}})}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){}onPause(){}onResume(){}onResize(t,e,i){}}var E=i(5298);let L,F,A;!function(t){t.wall="wall",t.divider="divider",t.line="line",t.shield="shield",t.brick="brick",t.bonus="bonus",t.ball="ball"}(L||(L={})),function(t){t[t.none=0]="none",t[t.wall=1]="wall",t[t.divider=2]="divider",t[t.line=4]="line",t[t.shield=8]="shield",t[t.brick=16]="brick",t[t.bonus=32]="bonus",t[t.ball=64]="ball"}(F||(F={})),function(t){t.wall="wall",t.divider="divider",t.line="line",t.shield="shield",t.brick="brick",t.bonus="bonus",t.ball="ball"}(A||(A={}));var z=i(161),I=i.n(z);const O=new(I()),q={pair:[{},{}]};class V{get filterMap(){return this._filterMap}constructor(t,e){(0,y.Z)(this,"_filterMap",void 0),this._box2d=t,this._world=e,this._setContactListener(),this._initFilters()}static contactContainsGroups(t,e){const{pair:i}=q;return null!=V.getFromPair(i,"group",t)&&null!=V.getFromPair(i,"group",e)}static contactContains(t,e,i,s){const{pair:a}=q;return null!=V.getFromPair(a,t,e)&&null!=V.getFromPair(a,i,s)}static getFromPair(t,e,i){const[s,a]=t,{fixture:{plainUserData:n}}=s,{fixture:{plainUserData:o}}=a;return null!=n&&n[e]===i?s:null!=o&&o[e]===i?a:null}_setContactListener(){const t=Object.assign(new this._box2d.JSContactListener,{BeginContact:t=>{this._updateContactInfo(this._box2d.wrapPointer(t,this._box2d.b2Contact)),O.emit(f.bk.beginContact,q)},EndContact:t=>{this._updateContactInfo(this._box2d.wrapPointer(t,this._box2d.b2Contact)),O.emit(f.bk.endContact,q)},PreSolve:(t,e)=>{},PostSolve:(t,e)=>{O.emit(f.bk.postSolve,q)}});this._world.SetContactListener(t)}_updateContactInfo(t){const e=t.GetFixtureA(),i=t.GetFixtureB(),s=e.GetBody(),a=i.GetBody(),n=q.pair[0],o=q.pair[1];q.contact=t,q.isSensor=e.IsSensor()||i.IsSensor(),n.fixture=e,n.body=s,o.fixture=i,o.body=a}_initFilters(){const{none:t,wall:e,divider:i,line:s,brick:a,shield:n,bonus:o,ball:r}=F;this._filterMap={};const h=new this._box2d.b2Filter,l=new this._box2d.b2Filter,d=new this._box2d.b2Filter,c=new this._box2d.b2Filter,_=new this._box2d.b2Filter,u=new this._box2d.b2Filter,p=new this._box2d.b2Filter;h.set_categoryBits(e),h.set_maskBits(r),l.set_categoryBits(i),l.set_maskBits(r),d.set_categoryBits(s),d.set_maskBits(r),c.set_categoryBits(a),c.set_maskBits(r),_.set_categoryBits(n),_.set_maskBits(r),p.set_categoryBits(o),p.set_maskBits(r),u.set_categoryBits(r),u.set_maskBits(e|s|a|n|o|i),this._filterMap.wall=[h],this._filterMap.divider=[l],this._filterMap.line=[d],this._filterMap.brick=[c],this._filterMap.shield=[_],this._filterMap.bonus=[p],this._filterMap.ball=[u]}}var H=i(9535);const G=(t,e)=>{const{box2d:i}=a.l2.physics2D;return new i.b2Vec2(t,e)},j=(t,e)=>{const{box2d:i}=a.l2.physics2D,{b2EdgeShape:s}=i,n=new s;return n.SetTwoSided(t,e),n},N=(t,e)=>{const{box2d:i}=a.l2.physics2D,{b2CircleShape:s}=i,n=new s;return n.set_m_radius(t),null!=e&&n.set_m_p(G(e.x,e.y)),n},W=(t,e,i,s)=>{const{box2d:n}=a.l2.physics2D,{b2PolygonShape:o}=n,r=new o;let h=0;return null!=i&&(h=G(i.x,i.y)),r.SetAsBox(t/2,e/2,h,null!=s?s:0),r},J=t=>{var e;const{box2d:i}=a.l2.physics2D,{bodyDef:s,fixturesDefs:o,userData:r,filters:h}=t,l=new i.b2BodyDef;(0,n.XP)(s).forEach((t=>{const e="set_".concat(t);l[e](s[t])}));const d=null===(e=a.l2.physics2D)||void 0===e?void 0:e.world.CreateBody(l);return d.plainUserData=r,o.forEach(((t,e)=>{const s=new i.b2FixtureDef;(0,n.XP)(t).forEach((e=>{const i="set_".concat(e);s[i](t[e])})),null!=h&&s.set_filter(h[e]);d.CreateFixture(s).plainUserData=t.userData})),d};window.devicePixelRatio,u(1),Math.PI;class X{constructor(t,e){this._box2d=t,this._world=e}sync(){for(let t=this._world.GetBodyList();0!==this._box2d.getPointer(t);t=t.GetNext())t.GetType()!==this._box2d.b2_staticBody&&this.syncBodyTarget(t)}syncBodyTarget(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=t.plainUserData&&(e||t.IsEnabled())){const e=t.plainUserData.target;if(null==e)return;e.sync(t.GetTransform())}}}class ${constructor(t){(0,y.Z)(this,"_syncManager",void 0),(0,y.Z)(this,"_contactManager",void 0),(0,y.Z)(this,"_debugManager",void 0),(0,y.Z)(this,"_box2d",void 0),(0,y.Z)(this,"_world",void 0),this._app=t}get box2d(){return this._box2d}get world(){return this._world}get syncManager(){return this._syncManager}get contactManager(){return this._contactManager}get debugManager(){return this._debugManager}async onInstall(){this._box2d=await(0,E.Z)(),this._world=new this._box2d.b2World(new this._box2d.b2Vec2(0,0)),this._contactManager=new V(this._box2d,this._world),this._syncManager=new X(this._box2d,this._world)}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){this._world.Step(n.It,8,3),this._syncManager.sync()}onPause(){}onResume(){}onResize(t,e,i){}_logBodiesCount(){for(let t=this._world.GetBodyList();0!==this._box2d.getPointer(t);t=t.GetNext())0}}var Y=i(1796);const Q=()=>({name:"bg"}),K=()=>({name:"bg",bounds:a.l2.screen.viewBounds,cells:[{name:"cloud1",align:Y.Oo.rightCenter,bounds:{x:0,y:.115,width:1,height:.08}},{name:"mountain1",align:Y.Oo.leftCenter,offset:{x:30},bounds:{x:0,y:.115,width:1,height:.08}},{name:"mountain2",align:Y.Oo.rightCenter,bounds:{x:0,y:.58,width:1,height:.1},padding:{x:.75,y:.1,width:.25,height:.8}},{name:"mountain3",align:Y.Oo.leftCenter,bounds:{x:0,y:.68,width:1,height:.1}}]}),tt=()=>({name:"intro"}),et=()=>({name:"intro",bounds:a.l2.screen.viewBounds,cells:[{name:"logo",bounds:{x:0,y:.21,width:1,height:.24},padding:{x:.2,y:.05,width:.6,height:.9},offset:{x:-17}},{name:"tap_to_play",bounds:{x:0,y:.56,width:1,height:.07},padding:{x:.29,y:.15,width:.42,height:.7}},{name:"input_area",scale:Y.P1.fill,bounds:{x:0,y:.45,width:1,height:.58}},{name:"tutorial",align:Y.Oo.leftBottom,bounds:{x:0,y:.82,width:.5,height:.18}}]}),it=()=>({name:"result"}),st=()=>({name:"result",bounds:a.l2.screen.viewBounds,cells:[{name:"header",bounds:{x:0,y:0,width:1,height:.17},cells:[{name:"status",bounds:{x:0,y:0,width:1,height:1},offset:{x:0,y:50}}]},{name:"body",bounds:{x:0,y:.17,width:1,height:.63},cells:[{name:"player1",bounds:{x:0,y:0,width:1,height:.5},padding:{x:0,y:.08,width:1,height:.84}},{name:"player2",bounds:{x:0,y:.5,width:1,height:.5},padding:{x:0,y:.08,width:1,height:.84}}]},{name:"footer",bounds:{x:0,y:.8,width:1,height:.2},cells:[{name:"rematch_status",bounds:{x:.05,y:0,width:.9,height:.2},offset:{y:30}},{name:"home_btn",bounds:{x:0,y:.2,width:.5,height:.8},align:Y.Oo.rightCenter,offset:{x:-40}},{name:"action_btn",bounds:{x:.5,y:.2,width:.5,height:.8},align:Y.Oo.leftCenter,offset:{x:40}}]}]}),at=()=>({name:"room"}),nt=()=>({name:"room",bounds:a.l2.screen.viewBounds}),ot=()=>({name:"ui"}),rt=()=>{const t=.12;return{name:"ui",bounds:a.l2.screen.viewBounds,padding:{x:.02,y:0,width:.96,height:.09},cells:[{name:"user_rank",bounds:{x:.24,y:0,width:.52,height:1},padding:{x:.12,y:.2,width:.76,height:.6}},{name:"sector_horizontal",bounds:{x:0,y:0,width:1,height:1},align:Y.Oo.centerBottom,scale:Y.P1.custom},{name:"sector_vertical_left",bounds:{x:.24,y:0,width:.52,height:1},padding:{x:0,y:.34,width:1,height:.32},offset:{x:-220},scale:Y.P1.custom},{name:"sector_vertical_right",bounds:{x:.24,y:0,width:.52,height:1},padding:{x:0,y:.34,width:1,height:.32},offset:{x:220},scale:Y.P1.custom},{name:"sound",bounds:{x:0,y:0,width:t,height:1},padding:{x:0,y:.2,width:1,height:.6}},{name:"haptic",bounds:{x:t,y:0,width:t,height:1},padding:{x:0,y:.2,width:1,height:.6}},{name:"theme",bounds:{x:.88,y:0,width:t,height:1},padding:{x:0,y:.2,width:1,height:.6}}]}},ht=()=>({name:"versus"}),lt=()=>({name:"versus",bounds:a.l2.screen.viewBounds,cells:[{name:"player_vs_opponent",bounds:{x:0,y:.05,width:1,height:.8},cells:[{name:"opponent",bounds:{x:0,y:0,width:1,height:.45},align:Y.Oo.centerBottom,padding:.07},{name:"vs",bounds:{x:0,y:.45,width:1,height:.1}},{name:"player",bounds:{x:0,y:.55,width:1,height:.45},align:Y.Oo.centerTop,padding:.07}]},{name:"search",bounds:{x:0,y:.85,width:1,height:.15},padding:{x:0,y:.1,width:1,height:.21},align:Y.Oo.centerTop}]});let dt;!function(t){t.game="game",t.bg="bg",t.intro="intro",t.ui="ui",t.versus="versus",t.room="room",t.result="result"}(dt||(dt={}));class ct{constructor(){(0,y.Z)(this,"_config",new Map)}init(){}resize(t){this._config.set(dt.bg,(t=>({[n.i5.landscape]:Q(),[n.i5.portrait]:K()}[t]))(t)).set(dt.intro,(t=>({[n.i5.landscape]:tt(),[n.i5.portrait]:et()}[t]))(t)).set(dt.ui,(t=>({[n.i5.landscape]:ot(),[n.i5.portrait]:rt()}[t]))(t)).set(dt.versus,(t=>({[n.i5.landscape]:ht(),[n.i5.portrait]:lt()}[t]))(t)).set(dt.room,(t=>({[n.i5.landscape]:at(),[n.i5.portrait]:nt()}[t]))(t)).set(dt.result,(t=>({[n.i5.landscape]:it(),[n.i5.portrait]:st()}[t]))(t))}getConfig(t){return this._config.get(t)}}const _t=new class{constructor(){(0,y.Z)(this,"_gridLayout",new ct)}init(){this._gridLayout.init()}onResize(t){this._gridLayout.resize(t)}getGridConfig(t){const e=this._gridLayout.getConfig(t);if(null==e)throw new Error("Grid config not found for key: ".concat(t));return e}};var ut=i(8002),pt=i(4293),gt=i(2500),mt=i(5147),yt=JSON.parse('{"HelveticaRegular":{"fontFamily":"HelveticaRegular","fontSize":60,"fontWeight":"600"},"HelveticaLight":{"fontFamily":"HelveticaLight","fontSize":60,"fontWeight":"600"},"HelveticaBold":{"fontFamily":"HelveticaBold","fontSize":100,"fontWeight":"600"}}');const vt={"tap-to-play":"tap-to-play","well-done":"well-done",go:"go",home:"home",start:"start",rematch:"rematch",approve:"approve",waiting:"waiting","new-game":"new-game","rematch-approved":"rematch-approved","player-rematch-request":"player-rematch-request","opponent-rematch-request":"opponent-rematch-request","opponent-rematch-reject":"opponent-rematch-reject","protect-your-castle":"protect-your-castle","protect-fail-01":"protect-fail-01","protect-fail-02":"protect-fail-02","protect-success-01":"protect-success-01","protect-success-02":"protect-success-02","protect-success-03":"protect-success-03","protect-success-04":"protect-success-04","searching-opponent":"searching-opponent","latin-script-special-characters":"latin-script-special-characters",__charset__:"TAP OLYWEDNG!HMSRCV?Iematchprovdingfl.qusj\nUy'¡¿·ÄäÀàÁáÂâÃãÅåǍǎĄąĂăÆæĀāÇçĆćĈĉČčĎđĐďðÈèÉéÊêËëĚěĘęĖėĒēĜĝĢģĞğĤĥÌìÍíÎîÏïıĪīĮįĴĵĶķĹĺĻļŁłĽľĿŀÑñŃńŇňŅņÖöÒòÓóÔôÕõŐőØøŒœŔŕŘřẞßŚśŜŝŞşŠšȘșŤťŢţÞþȚțÜüÙùÚúÛûŰűŨũŲųŮůŪūŴŵÝýŸÿŶŷŹźŽžŻż\"#$%&()*+,-/0123456789:;<=>@BFJKQXZ[\\]^_`bkwxz{|}~"};var bt=i(8545);function wt(t,e,i,s,a,n,o){const r=i.text,h=i.fontProperties;e.translate(s,a),e.scale(n,n);const l=o.strokeThickness/2,d=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,i,s,a,n){const o=i.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];let r;const h=i.dropShadow?i.dropShadowDistance:0,l=i.padding||0,d=t.width/s-h-2*l,c=t.height/s-h-2*l,_=o.slice(),u=i.fillGradientStops.slice();if(0===u.length){const t=_.length+1;for(let e=1;e<t;++e)u.push(e/t)}if(_.unshift(o[0]),u.unshift(0),_.push(o[o.length-1]),u.push(1),i.fillGradientType===H.M_1.LINEAR_VERTICAL){r=e.createLinearGradient(d/2,l,d/2,c+l);let t=0;const s=(n.fontProperties.fontSize+i.strokeThickness)/c;for(let e=0;e<a.length;e++){const i=n.lineHeight*e;for(let e=0;e<_.length;e++){let a=0;a="number"==typeof u[e]?u[e]:e/_.length;const n=i/c+a*s;let o=Math.max(t,n);o=Math.min(o,1),r.addColorStop(o,_[e]),t=o}}}else{r=e.createLinearGradient(l,c/2,d+l,c/2);const t=_.length+1;let i=1;for(let e=0;e<_.length;e++){let s;s="number"==typeof u[e]?u[e]:i/t,r.addColorStop(s,_[e]),i++}}return r}(t,e,o,n,[r],i),e.strokeStyle=o.stroke,o.dropShadow){const t=o.dropShadowColor,i=H.P6Y.hex2rgb("number"==typeof t?t:H.P6Y.string2hex(t)),s=o.dropShadowBlur*n,a=o.dropShadowDistance*n;e.shadowColor="rgba(".concat(255*i[0],",").concat(255*i[1],",").concat(255*i[2],",").concat(o.dropShadowAlpha,")"),e.shadowBlur=s,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*a,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*a}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(r,l,d+i.lineHeight-h.descent),o.fill&&e.fillText(r,l,d+i.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function ft(t){"string"==typeof t&&(t=[t]);const e=[];for(let s=0,a=t.length;s<a;s++){const a=t[s];if(Array.isArray(a)){if(2!==a.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(a.length,"."));const t=a[0].charCodeAt(0),i=a[1].charCodeAt(0);if(i<t)throw new Error("[BitmapFont]: Invalid character range.");for(let s=t,a=i;s<=a;s++)e.push(String.fromCharCode(s))}else e.push(...(i=a,Array.from?Array.from(i):i.split("")))}var i;if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}function xt(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}class St{constructor(){(0,y.Z)(this,"_loader",new H.aNw)}async load(t,e){return await new Promise((i=>{const{images:a,spines:n,atlases:o,sounds:r}=t[s.J0.pixi];!(0,C.Z)(a)&&this.__loadImages__(a),!(0,C.Z)(o)&&this.__loadAtlases__(o),!(0,C.Z)(r)&&this.__loadSounds__(r),!(0,C.Z)(n)&&this.__loadSpines__(n),this._loader.load((()=>i())),this._loader.onProgress.add((()=>e()))}))}async onGenericAssetLoad(t,e){switch(t){case"sound":this._processSound(e);break;case"font":this._processFont(e)}}_processSound(t){}_processFont(t){const e=(0,mt.Z)(yt,(e=>e.fontFamily===t));Object.keys(e).forEach((t=>{const i=(0,gt.Z)({fontSize:60,fill:"#ffffff"},e[t]);!function(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:a,padding:n,resolution:o,textureWidth:r,textureHeight:h}=Object.assign({},H.UPD.defaultOptions,i),l=ft(a),d=e instanceof H.pn8?e:new H.pn8(e),c=r,_=new H.d0Z;_.info[0]={face:d.fontFamily,size:d.fontSize},_.common[0]={lineHeight:d.fontSize};let u,p,g,m=0,y=0,v=0;const b=[],w=[];for(let t=0;t<l.length;t++){u||(u=document.createElement("canvas"),u.width=r,u.height=h,p=u.getContext("2d"),g=new H.VL4(u,{resolution:o}),b.push(g),w.push(new H.xEZ(g)),_.page.push({id:w.length-1,file:""}));const e=H._A.measureText(l[t],d,!1,u),i=e.width,s=Math.ceil(e.height),a=Math.ceil(("italic"===d.fontStyle?2:1)*i);if(y>=h-s*o){if(0===y)throw new Error("[BitmapFont] textureHeight ".concat(h,"px is ")+"too small for ".concat(d.fontSize,"px fonts"));--t,u=null,p=null,g=null,y=0,m=0,v=0;continue}if(v=Math.max(s+e.fontProperties.descent,v),a*o+m>=c){--t,y+=v*o,y=Math.ceil(y),m=0,v=0;continue}wt(u,p,e,m,y,o,d);const f=xt(e.text);_.char.push({id:f,page:w.length-1,x:m/o,y:y/o,width:a,height:s,xoffset:0,yoffset:0,xadvance:Math.ceil(i-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),m+=(a+2*n)*o,m=Math.ceil(m)}if(s)for(let t=0,e=l.length;t<e;t++){const i=l[t];for(let t=0;t<e;t++){const e=l[t],s=p.measureText(i).width,a=p.measureText(e).width,n=p.measureText(i+e).width-(s+a);n&&_.kerning.push({first:xt(i),second:xt(e),amount:n})}}const f=new H.UPD(_,w,!0);void 0!==H.UPD.available[t]&&H.UPD.uninstall(t),H.UPD.available[t]=f}(t,new H.pn8(i),(0,gt.Z)({chars:vt.__charset__,textureHeight:1024,textureWidth:1024,padding:.1*i.fontSize,resolution:l()},i))}))}async __loadAtlases__(t){t.forEach((t=>{const{json:e,image:i}=Z.L.atlases[t];this._loader.add({key:t,url:i,onComplete:t=>{!async function(t,e){const{texture:i}=t;if(null==i)return;const s=new H.c2G(i.baseTexture,e);await s.parse()}(t,e)}})}))}__loadImages__(t){t.forEach((t=>{const e=Z.L.images[t];this._loader.add({key:t,url:e})}))}__loadSounds__(t){t.forEach((t=>{const e=Z.L.sounds[t];this._loader.add({key:t,url:e})}))}__loadSpines__(t){t.forEach((t=>{const{atlas:e,json:i,image:s}=Z.L.spines[t];this._loader.add({key:t,url:s,onComplete:t=>{kt(t,i,e)}})}))}}async function kt(t,e,i){const{texture:s}=t;if(null==s)return;const a=new ut.Yi(i,((t,e)=>{e(s.baseTexture)})),n=new pt.N0(a),o=new pt.CE(n).readSkeletonData(e);bt.U[t.name].skeleton=o}var Ct=i(1114),Tt=i(4984),Pt=i(2552);const Zt=(t,e)=>({alpha:0,duration:.3,universal:!0,ease:e,callbackScope:t}),Dt=(t,e,i)=>({pixi:{alpha:t,scale:1},duration:e,universal:!0,ease:Tt.eJ.easeOut.config(i)});var Mt=i(9261),Bt=i(6495);const Ut=t=>({texture:Bt.P["bg-mountain-".concat(t)]}),Rt=()=>({texture:Bt.P.ball}),Et=()=>({position:{x:0,y:84},texture:Bt.P["winner-stars"]});var Lt=i(4717);class Ft extends H.TCu{constructor(){super(...arguments),(0,y.Z)(this,"userData",void 0)}shape(t){return this.drawShape(this.hitArea=t),this}input(t){return this.interactive=t,this}setUserDate(t){return this.userData=t,this}}class At extends pt.PY{update(){super.update(H.vB5.shared.deltaMS/1e3)}}const zt=t=>(0,n.RI)(t,"width")&&(0,n.RI)(t,"height")?(t=>{const{texture:e,data:i,width:s,height:a,tint:n=16777215,scale:o={x:1,y:1},position:r={x:0,y:0},anchor:{x:h,y:l}={x:.5,y:.5}}=t,d=new H.ZTM(H.xEZ.from(e),...i);return d.width=s,d.height=a,d.position.copyFrom(r),d.scale.copyFrom(o),d.pivot.set(h*s,l*a),d.tint=n,d})(t):(t=>{const{texture:e,position:i={x:0,y:0},scale:s={x:1,y:1},anchor:a={x:.5,y:.5},tint:n=16777215}=t,o=H.jyi.from(e);return o.scale.copyFrom(s),o.anchor.copyFrom(a),o.position.copyFrom(i),o.tint=n,o})(t),It=t=>{const{parent:e,config:i}=t;return new Lt.Q5(e,i)},Ot=t=>(0,n.RI)(t.style,"fontName")?(t=>{const{text:e,style:i,position:s={x:0,y:0},scale:a={x:1,y:1},anchor:n={x:.5,y:.5}}=t,o=new H.Xz2(null!=e?e:"undefined",i);return o.position.copyFrom(s),o.scale.copyFrom(a),o.anchor.copyFrom(n),o})(t):(t=>{const{text:e,style:i,position:s={x:0,y:0},scale:a={x:1,y:1},anchor:n={x:.5,y:.5}}=t,o=new H.xvT(e,i);return o.position.copyFrom(s),o.scale.copyFrom(a),o.anchor.copyFrom(n),o})(t),qt=(t,e,i)=>{t instanceof H.xvT?((t,e,i)=>{var s,a;null==t.defaultFontSize&&(t.defaultFontSize=t.style.fontSize),t.style.fontSize=t.defaultFontSize;const{width:n,height:o,scale:r}=t,h=null!==(s=e/(n/r.x))&&void 0!==s?s:1,l=null!==(a=i/(o/r.y))&&void 0!==a?a:1,d=Math.min(Math.min(h,l),1);t.style.fontSize*=d})(t,e,i):((t,e,i)=>{var s,a;null==t.defaultFontSize&&(t.defaultFontSize=t.fontSize),t.fontSize=t.defaultFontSize;const n=null!==(s=e/t.width)&&void 0!==s?s:1,o=null!==(a=i/t.height)&&void 0!==a?a:1,r=Math.min(Math.min(n,o),1);t.fontSize*=r})(t,e,i)};class Vt extends Y.D3{constructor(){super(),(0,y.Z)(this,"_bgDiv",void 0),(0,y.Z)(this,"_gameDiv",void 0),b.q.event.on(w.ce.themeUpdate,this._onThemeUpdate,this),this._build(),this._applyTheme()}getGridConfig(){return _t.getGridConfig(dt.bg)}onShowStart(){this.cacheAsBitmap=!1}onShowComplete(){}onHideStart(){this.cacheAsBitmap=!0}onHideComplete(){}onResize(){super.rebuild(this.getGridConfig())}onUpdate(t,e){}_build(){this._gameDiv=document.getElementById("game_div"),this._bgDiv=document.getElementById("game_bg");const t=zt((e="01",{texture:Bt.P["bg-cloud-".concat(e)]}));var e;const i=zt(Ut("01")),s=zt(Ut("02")),a=zt(Ut("03"));this.setChild("cloud1",t),this.setChild("mountain1",i),this.setChild("mountain2",s),this.setChild("mountain3",a),c()||(this._gameDiv.style.border="8px solid rgba(255, 255, 255, .3)",this._gameDiv.style.boxSizing="border-box")}_applyTheme(){this._onThemeUpdate()}_updateBackground(t){let{c1:e,c2:i,c3:s}=t;this._bgDiv.style.backgroundImage="linear-gradient(".concat(e,", ").concat(i,", ").concat(s,")")}_onThemeUpdate(){this._updateBackground(Mt.X.getBg().gradient)}}class Ht{constructor(){(0,y.Z)(this,"view",void 0),this.view=(t=>{const{name:e,interactive:i=!1,shape:s=new H.AeJ(0,0,0,0),fill:{color:a,alpha:n}={color:16711680,alpha:1}}=t;return(new Ft).setUserDate(e).input(i).beginFill(a,n).shape(s)})({interactive:!0,fill:{color:16777215,alpha:.001},shape:new H.AeJ(0,0,100,100)})}start(){this.view.input(!0)}stop(){this.view.input(!1)}}class Gt{constructor(){(0,y.Z)(this,"view",void 0),this.view=zt({texture:Bt.P["intro-logo-dark"]})}updateTheme(t){let{texture:e}=t;this.view.texture=H.xEZ.from(e)}}const jt={HelveticaBold:"HelveticaBold",HelveticaLight:"HelveticaLight",HelveticaRegular:"HelveticaRegular"},Nt={HelveticaRegular:"HelveticaRegular",HelveticaLight:"HelveticaLight",HelveticaBold:"HelveticaBold"},Wt=()=>({text:a.l2.localization.get(vt["searching-opponent"]),style:{letterSpacing:8,fontName:Nt.HelveticaLight,fontSize:47}});class Jt{constructor(){(0,y.Z)(this,"view",void 0),this.view=Ot({text:a.l2.localization.get(vt["tap-to-play"]),anchor:{x:.5,y:.5},style:{fontName:Nt.HelveticaLight,fontSize:60}})}updateTheme(t){let{color:e}=t;this.view.tint=e}}class Xt extends H.W20{constructor(t){super(),(0,y.Z)(this,"_hand",void 0),(0,y.Z)(this,"_line",void 0),(0,y.Z)(this,"_text",void 0),(0,y.Z)(this,"_ball",void 0),(0,y.Z)(this,"_showTimeline",void 0);const{label:e}=t;this.addChild(this._line=this._createLine()),this.addChild(this._hand=this._createHand()),this.addChild(this._text=this._createText(e)),this.addChild(this._ball=this._createBall()),this._initTweens(t),this.start()}destroy(){this._showTimeline.kill(),super.destroy()}stop(){this.visible=!1,this._showTimeline.totalProgress(0),this._showTimeline.kill()}start(){this.visible=!1,this._showTimeline.invalidate(),this._showTimeline.restart()}updateTheme(t){let{line:e,ball:i,text:s,hand:a}=t;this._ball.tint=i,this._text.tint=s,this._line.tint=e,this._hand.tint=a}_initTweens(t){const{hand:e,ball:i}=this._calculateTrajectories(t),{delay:s,repeatDelay:a}=t;this._showTimeline=Ct.ZP.timeline({delay:s,repeat:-1,repeatDelay:a,universal:!0,onStart:()=>{this._hand.position.set(e.from.x,e.from.y),this._ball.position.set(i.from.x,i.from.y),this._line.position.set(e.from.x,e.from.y),this._line.lineTo(e.line.length,e.from.x),this._line.rotation=e.line.angle,this._line.scale.set(0,1),this.visible=!0,this._ball.alpha=0,this._hand.alpha=0,this._text.alpha=0,this._line.alpha=0}}),this._showTimeline.add((()=>Ct.ZP.to(this._ball,{pixi:{alpha:1},duration:1,yoyo:!0,repeat:1,ease:Tt.Yv.easeOut}))(),0),this._showTimeline.add((()=>Ct.ZP.to(this._ball,{pixi:{x:i.to.x,y:i.to.y},duration:1,yoyo:!0,repeat:1,ease:Tt.bJ.easeNone}))(),0),this._showTimeline.add((()=>Ct.ZP.to([this._hand,this._text],{pixi:{alpha:1},duration:.3,ease:Tt.bJ.easeNone}))(),.2),this._showTimeline.add((()=>Ct.ZP.to([this._hand,this._text],{pixi:{x:"+=".concat(e.to.x),y:"+=".concat(e.to.y)},duration:.6,ease:Tt.Yv.easeInOut}))(),.2),this._showTimeline.add((()=>Ct.ZP.to([this._line],{pixi:{alpha:1},duration:.1,ease:Tt.bJ.easeNone}))(),.2),this._showTimeline.add((()=>Ct.ZP.to([this._line],{pixi:{scaleX:1},duration:.6,ease:Tt.Yv.easeInOut}))(),.2),this._showTimeline.add((()=>Ct.ZP.to([this],{pixi:{alpha:0},duration:.4,ease:Tt.bJ.easeNone}))(),1.8),this._showTimeline.pause()}_calculateTrajectories(t){const{length:e,angle:i,distance:s}=t,a=e,n=i,o=s,r=n-.5*Math.PI,{x:h,y:l}=this._hand.position,{x:d,y:c}=this._ball.position,_=h,u=l,p=_+a*Math.cos(n),g=u+a*Math.sin(n),m=p/2,y=g/2;return{hand:{from:{x:_,y:u},to:{x:p,y:g},line:{length:a,angle:n}},ball:{from:{x:m+o*Math.cos(r),y:y+o*Math.sin(r)},to:{x:d+m+25*Math.cos(r),y:c+y+25*Math.sin(r)},line:{angle:r,length:o}}}}_createHand(){return zt({texture:Bt.P["intro-tutorial-hand"],anchor:{x:.125,y:.015}})}_createText(t){return Ot((t=>({text:t,anchor:{x:0,y:0},position:{x:140,y:70},style:{letterSpacing:4,fontName:Nt.HelveticaBold,fontSize:27}}))(t))}_createBall(){return zt(Rt())}_createLine(){const t=new H.TCu;return t.lineStyle({cap:H.$oy.ROUND,color:16777215,width:7,alpha:1}),t}}class $t{constructor(){(0,y.Z)(this,"view",void 0),(0,y.Z)(this,"_fence",void 0),(0,y.Z)(this,"_tutorial",void 0),this.view=new H.W20,this.view.addChild(this._fence=this._createFence()),this.view.addChild(this._tutorial=this._createTutorial()),this.view.getBounds=()=>this._fence.getBounds()}updateTheme(t){let{fence:e,protect:i}=t;this._fence.tint=e.color,this._tutorial.updateTheme(i)}stop(){this._tutorial.stop()}start(){this._tutorial.start()}_createFence(){return zt({texture:Bt.P["intro-tutorial-fence"]})}_createTutorial(){const t=new Xt({delay:1,repeatDelay:1,length:250,angle:.25*Math.PI,distance:600,label:a.l2.localization.get(vt["protect-your-castle"])});return t.position.set(210,-230),t}}class Yt extends Y.D3{constructor(){super(),(0,y.Z)(this,"_logo",void 0),(0,y.Z)(this,"_tutorial",void 0),(0,y.Z)(this,"_tapToPlay",void 0),(0,y.Z)(this,"_inputArea",void 0),b.q.event.on(w.ce.themeUpdate,this._onThemeUpdate,this),this._build(),this._applyTheme()}getGridConfig(){return _t.getGridConfig(dt.intro)}onResize(){super.rebuild(this.getGridConfig())}onUpdate(t,e){}onShowStart(){this.cacheAsBitmap=!1,this._tutorial.start()}onShowComplete(){b.q.event.emit(f.Is.showComplete),this._inputArea.start()}onHideStart(){this.cacheAsBitmap=!0,this._inputArea.stop()}onHideComplete(){this._tutorial.stop()}_onThemeUpdate(){const{logo:t,play:e}=Mt.X.getIntro(),i=Mt.X.getTutorial();this._logo.updateTheme(t),this._tapToPlay.updateTheme(e),this._tutorial.updateTheme(i)}_build(){this._buildLogo(),this._buildTapToPlay(),this._buildTapToPlayArea(),this._buildTutorial()}_applyTheme(){this._onThemeUpdate()}_buildLogo(){this._logo=new Gt,this.setChild("logo",this._logo.view)}_buildTapToPlay(){this._tapToPlay=new Jt,this.setChild("tap_to_play",this._tapToPlay.view)}_buildTapToPlayArea(){this._inputArea=new Ht,this._inputArea.view.on("pointerdown",this._onPlayClick,this),this.setChild("input_area",this._inputArea.view)}_buildTutorial(){this._tutorial=new $t,this.setChild("tutorial",this._tutorial.view)}_onPlayClick(){b.q.event.emit(f.Is.playClick)}}var Qt=i(2706);const Kt=(t,e,i)=>({texture:t,data:[48,50,48,50],width:e,height:i});class te extends Ft{constructor(t){super(),(0,y.Z)(this,"strategy",void 0),this.setStrategy(t).initInput(t.config.input)}enable(t){return this.strategy.up(),this.input(t),!t&&this.strategy.disable(),this}initInput(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{area:e,name:i,enable:s}=Object.assign({enable:!0},t);return this.setUserDate(i).shape(null!=e?e:this.getLocalBounds()).enable(s).on("pointerover",this.over,this).on("pointerout",this.out,this).on("pointerdown",this.down,this).on("pointertap",this.up,this).on("pointerupoutside",this.upOut,this),this}setStrategy(t){return this.strategy=t,this.strategy.init(this),this}down(t){this.strategy.down()}up(t){this.strategy.up(),this.emit("interaction",this.userData)}over(t){this.strategy.over()}out(t){this.strategy.up()}upOut(t){this.strategy.up()}}class ee extends Ft{constructor(t){super(),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_textureOn",void 0),(0,y.Z)(this,"_textureOff",void 0),this._config=t,this.initVisuals(this._config.states),this.initInput(this._config.input)}get bg(){return this._bg}setState(t){this._bg.texture=t===s.rs.on?this._textureOn:this._textureOff}initVisuals(t){this._textureOn=H.xEZ.from(t.on.texture),this._textureOff=H.xEZ.from(t.off.texture),this.addChild(this._bg=new H.jyi(this._textureOn))}initInput(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{area:e,name:i,enable:s}=Object.assign({enable:!0},t);return this.setUserDate(i).shape(null!=e?e:this.getLocalBounds()).on("pointerdown",this.down,this),this.interactive=s,this}down(){this.emit("interaction")}}class ie{constructor(t){(0,y.Z)(this,"view",void 0),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_label",void 0),(0,y.Z)(this,"_textures",void 0),this._config=t}get config(){return this._config}get bg(){return this._bg}get label(){return this._label}init(t){const{bg:e,label:i,textures:s}=this._config;this._bg=this._createBg(e),this._label=this._createLabel(i),this._textures=this._createTextures(s);const a=new H.W20;a.addChild(this._bg),a.addChild(this._label),this._fitLabel(),t.addChild(this.view=a)}up(){var t,e,i,s,a,n;const{label:o}=this._config.textures.up;this._bg.texture=this._textures.up,this._label.tint=o.tint,this._label.position.x=(null!==(t=null===(e=this._config.label)||void 0===e||null===(i=e.position)||void 0===i?void 0:i.x)&&void 0!==t?t:0)+o.offset.x,this._label.position.y=(null!==(s=null===(a=this._config.label)||void 0===a||null===(n=a.position)||void 0===n?void 0:n.y)&&void 0!==s?s:0)+o.offset.y}down(){var t,e,i,s,a,n,o;if(null==this._config.textures.down)return;const{label:r}=this._config.textures.down;this._bg.texture=null!==(t=this._textures.down)&&void 0!==t?t:this._textures.up,this._label.tint=r.tint,this._label.position.x=(null!==(e=null===(i=this._config.label)||void 0===i||null===(s=i.position)||void 0===s?void 0:s.x)&&void 0!==e?e:0)+r.offset.x,this._label.position.y=(null!==(a=null===(n=this._config.label)||void 0===n||null===(o=n.position)||void 0===o?void 0:o.y)&&void 0!==a?a:0)+r.offset.y}over(){var t,e,i,s,a,n,o;if(null==this._config.textures.over)return;const{label:r}=this._config.textures.over;this._bg.texture=null!==(t=this._textures.over)&&void 0!==t?t:this._textures.up,this._label.tint=r.tint,this._label.position.x=(null!==(e=null===(i=this._config.label)||void 0===i||null===(s=i.position)||void 0===s?void 0:s.x)&&void 0!==e?e:0)+r.offset.x,this._label.position.y=(null!==(a=null===(n=this._config.label)||void 0===n||null===(o=n.position)||void 0===o?void 0:o.y)&&void 0!==a?a:0)+r.offset.y}disable(){var t,e,i,s,a,n,o;if(null==this._config.textures.disable)return;const{label:r}=this._config.textures.disable;this._bg.texture=null!==(t=this._textures.disable)&&void 0!==t?t:this._textures.up,this._label.tint=r.tint,this._label.position.x=(null!==(e=null===(i=this._config.label)||void 0===i||null===(s=i.position)||void 0===s?void 0:s.x)&&void 0!==e?e:0)+r.offset.x,this._label.position.y=(null!==(a=null===(n=this._config.label)||void 0===n||null===(o=n.position)||void 0===o?void 0:o.y)&&void 0!==a?a:0)+r.offset.y}_fitLabel(){var t;const{x:e,y:i}=null!==(t=this._config.label.buttonFit)&&void 0!==t?t:{x:this._bg.width,y:this._bg.height},s=e*this._bg.width,a=i*this._bg.height;qt(this._label,s,a)}_createBg(t){return zt(t)}_createLabel(t){return Ot(t)}_createTextures(t){const e={};return(0,n.XP)(t).forEach((i=>{const s=t[i];null!=s&&(e[i]=H.xEZ.from(s.bg.texture))})),e}}class se extends te{constructor(t){super(new ie(t)),(0,y.Z)(this,"_wiggleTween",void 0),this._wiggleTween=this._getWiggleTween()}getLocalBounds(){const{x:t,y:e,width:i,height:s}=this.strategy.bg.getLocalBounds();return new H.AeJ(t-i/2,e-s/2,i,s)}getBounds(){return this.strategy.bg.getBounds()}startWiggle(t){this._wiggleTween.delay(t),this._wiggleTween.restart(!0)}stopWiggle(){this._wiggleTween.totalProgress(0).kill()}_getWiggleTween(){const{timelineVars:t,tweensVars:e}={timelineVars:{repeatDelay:2,repeat:-1,universal:!0,paused:!0},tweensVars:[{pixi:{angle:6,scale:1.08},repeat:1,yoyo:!0,duration:.06},{pixi:{angle:-6,scale:1.08},repeat:1,yoyo:!0,duration:.06}]},i=Ct.ZP.timeline(t);return i.add(Ct.ZP.to(this,e[0])),i.add(Ct.ZP.to(this,e[1])),i}}let ae;!function(t){t.rematch="rematch",t.approve="approve",t.newGame="new-game",t.waiting="waiting",t.start="start"}(ae||(ae={}));class ne extends se{constructor(){super({input:{enable:!0},bg:Kt(Bt.P["btn-blue"],400,110),label:{text:" ",position:{x:0,y:-6},style:{fontName:Nt.HelveticaRegular,letterSpacing:6,fontSize:42}},textures:{up:{bg:{texture:Bt.P["btn-blue"]},label:{tint:69739,offset:{x:0,y:0}}},disable:{bg:{texture:Bt.P["btn-disable"]},label:{tint:3356756,offset:{x:0,y:0}}}}}),(0,y.Z)(this,"_action",void 0),this.on("interaction",this._onInteraction,this)}get action(){return this._action}set action(t){this._action=t,this.strategy.label.text=a.l2.localization.get(vt[this._action])}reset(){this.action=ae.rematch}setStatus(t){switch(t){case Qt.$.opponentRematchRequest:this.action=ae.approve,this.startWiggle(0);break;case Qt.$.playerRematchApprove:case Qt.$.opponentRematchApprove:this.enable(!0),this.startWiggle(0),this.action=ae.start;break;case Qt.$.opponentRematchReject:this.enable(!0),this.startWiggle(0),this.action=ae.newGame;break;case Qt.$.playerRematchRequest:this.enable(!1),this.stopWiggle(),this.action=ae.waiting;break;default:this.stopWiggle()}}_onInteraction(){this.emit("action",this._action)}}class oe extends se{constructor(){super({input:{enable:!0},bg:Kt(Bt.P["btn-yellow"],400,110),label:{text:a.l2.localization.get(vt.home),position:{x:0,y:-6},style:{fontName:Nt.HelveticaRegular,letterSpacing:6,fontSize:42}},textures:{up:{bg:{texture:Bt.P["btn-yellow"]},label:{tint:6890419,offset:{x:0,y:0}}},disable:{bg:{texture:Bt.P["btn-disable"]},label:{tint:4536914,offset:{x:0,y:0}}}}})}reset(){this.enable(!0)}setStatus(t){switch(t){case Qt.$.playerRematchApprove:case Qt.$.opponentRematchApprove:this.enable(!1),this.stopWiggle()}}}class re extends H.W20{constructor(t){super(),(0,y.Z)(this,"_left",void 0),(0,y.Z)(this,"_right",void 0),(0,y.Z)(this,"_tint",16777215),this._left=zt(Et()),this._right=zt(Et()),this._right.scale.set(-1,1),this._left.x=.5*-t,this._right.x=.5*t,this.addChild(this._left,this._right)}get tint(){return this._tint}set tint(t){this._tint=t,this._left.tint=t,this._right.tint=t}}class he extends H.W20{constructor(){super(),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_name",void 0),(0,y.Z)(this,"_laurel",void 0),(0,y.Z)(this,"_flag",void 0),(0,y.Z)(this,"_frame",void 0),(0,y.Z)(this,"_stars",void 0),this._bg=this._buildBg(),this._name=this._buildName(),this._laurel=this._buildLaurel(),this._frame=this._buildFrame(),this._stars=this._buildStars(),this._flag=this._buildFlag(),this.addChild(this._bg,this._name,this._laurel,this._frame,this._stars,this._flag),this.cacheAsBitmap=!0}applyTheme(t){let{fenceColor:e,nameColor:i,frameColor:s}=t;this._bg.tint=e,this._name.tint=i,this._stars.tint=e,this._frame.tint=s,this._laurel.tint=s}setWinner(t,e){this.cacheAsBitmap=!1,this._bg.texture=H.xEZ.from(Bt.P["winner-castle"]),this._flag.text=s.id.get(t.countryCode),this._name.text=t.name.toUpperCase(),this._flag.visible=!0,this._frame.visible=!0,this._laurel.visible=!0,this._stars.visible=e,qt(this._flag,130,170),qt(this._name,.9*this._bg.width,this._name.height),this.cacheAsBitmap=!0}setLoser(t,e){this.cacheAsBitmap=!1,this._bg.texture=H.xEZ.from(Bt.P["loser-castle"]),this._name.text=t.name.toUpperCase(),this._flag.visible=!1,this._frame.visible=!1,this._laurel.visible=!1,this._stars.visible=!1,this.cacheAsBitmap=!0}_buildBg(){const t=H.jyi.from(H.xEZ.EMPTY);return t.anchor.set(.5),t}_buildName(){return Ot({text:" ",position:{x:0,y:210},style:{fontName:Nt.HelveticaLight,align:"center",fontSize:54}})}_buildLaurel(){return zt({position:{x:0,y:84},texture:Bt.P.laurel})}_buildFrame(){return zt({texture:Bt.P["white-border"],data:[10,10,10,10],width:560,height:560})}_buildStars(){const t=new re(900);return t.position.set(0,-110),t}_buildFlag(){return Ot({text:"🏁",position:{x:0,y:78},style:{fontFamily:jt.HelveticaRegular,fontSize:140}})}}const le={[Qt.$.playerRematchRequest]:vt["player-rematch-request"],[Qt.$.opponentRematchRequest]:vt["opponent-rematch-request"],[Qt.$.opponentRematchReject]:vt["opponent-rematch-reject"]};class de extends H.Xz2{constructor(){super(" ",{fontName:Nt.HelveticaLight,fontSize:50})}applyTheme(t){let{color:e}=t;this.tint=e}reset(){this.text=" "}setStatus(t){switch(t){case Qt.$.playerRematchRequest:case Qt.$.opponentRematchRequest:case Qt.$.opponentRematchReject:this.text=a.l2.localization.get(le[t]);break;case Qt.$.opponentRematchApprove:case Qt.$.playerRematchApprove:this.text=a.l2.localization.get(vt["rematch-approved"])}}}class ce extends H.jyi{constructor(){super(H.xEZ.EMPTY),this.anchor.set(.5)}applyTheme(t){let{color:e}=t;this.tint=e}setStatus(t){this.texture=H.xEZ.from(t?Bt.P["winner-text"]:Bt.P["loser-text"])}}class _e extends Y.D3{constructor(){super(),(0,y.Z)(this,"_player1",void 0),(0,y.Z)(this,"_player2",void 0),(0,y.Z)(this,"_status",void 0),(0,y.Z)(this,"_rematch",void 0),(0,y.Z)(this,"_btnAction",void 0),(0,y.Z)(this,"_btnHome",void 0),this._buildHeader(),this._buildBody(),this._buildFooter(),b.q.event.on(w.N.resultUpdate,this._onResultUpdate,this),b.q.event.on(w.d5.statusUpdate,this._onResultStatusUpdate,this)}getGridConfig(){return _t.getGridConfig(dt.result)}onResize(){super.rebuild(this.getGridConfig())}onUpdate(t,e){}onShowStart(){this.cacheAsBitmap=!1,this._rematch.reset(),this._btnHome.reset(),this._btnAction.reset(),this._btnHome.enable(!0),this._btnAction.enable(!0),this._btnHome.input(!1),this._btnAction.input(!1)}onShowComplete(){this._btnHome.input(!0),this._btnAction.input(!0),this._btnAction.startWiggle(1)}onHideStart(){this._btnHome.enable(!1),this._btnAction.enable(!1),this._btnHome.stopWiggle(),this._btnAction.stopWiggle(),this.cacheAsBitmap=!0}onHideComplete(){this._rematch.reset(),this._btnHome.reset(),this._btnAction.reset()}_applyTheme(){const{winner:t,loser:e,status:i,rematch:s}=Mt.X.getResult();this._status.applyTheme(i),this._rematch.applyTheme(s),this._player1.applyTheme(t),this._player2.applyTheme(e)}_onResultUpdate(t){null!=t?this._buildResult(t):this._destroyResult()}_onResultStatusUpdate(t){this._rematch.setStatus(t),this._btnHome.setStatus(t),this._btnAction.setStatus(t),this.rebuildChild(this._rematch)}_buildResult(t){const{winner:e,loser:i,won:s}=t;this._status.setStatus(s),this._player1.setWinner(e,s),this._player2.setLoser(i,s),this._applyTheme()}_destroyResult(){}_buildHeader(){this._status=new ce,this.setChild("status",this._status)}_buildBody(){this._player1=new he,this._player2=new he,this.setChild("player1",this._player1),this.setChild("player2",this._player2)}_buildFooter(){this._rematch=new de,this.setChild("rematch_status",this._rematch),this._btnHome=new oe,this._btnAction=new ne,this._btnHome.on("interaction",this._onHomeBtnClick,this),this._btnAction.on("action",this._onActionBtnClick,this),this.setChild("home_btn",this._btnHome),this.setChild("action_btn",this._btnAction)}_onHomeBtnClick(){b.q.event.emit(f.a$.homeClick),b.q.event.emit(f.a$.roomLeave)}_onActionBtnClick(t){switch(b.q.event.emit(f.a$.actionClick),t){case ae.rematch:b.q.event.emit(f.a$.rematchRequest);break;case ae.approve:b.q.event.emit(f.a$.rematchApprove);break;case ae.newGame:b.q.event.emit(f.a$.newGame);break;case ae.start:b.q.event.emit(f.a$.start)}}}var ue=i(5286);class pe{constructor(t){(0,y.Z)(this,"_area",void 0),this._target=t,this._area=new n.UL}onResize(t){this._area.copyFrom(t)}reset(){this._target.position.set(0,0),this._target.pivot.set(0,0),this._target.scale.set(1,1)}panZoom(){const{width:t,height:e}=this._area,i=2-20/e;Ct.ZP.to(this._target,((t,e)=>({duration:1,ease:Tt.zO.easeIn,pixi:{scale:t,x:e.x,y:e.y}}))(i,{x:(t-t*i)/2,y:0}))}shake(){Ct.ZP.to(this._target,{duration:.3,ease:"shake",pixi:{pivotX:"-=20",pivotY:"-=20"}})}}class ge{constructor(){O.on(f.bk.beginContact,this._beginContact,this),O.on(f.bk.endContact,this._endContact,this)}_endContact(t){const{ball:e,divider:i}=L;if(!0===V.contactContainsGroups(e,i)){const i=V.getFromPair(t.pair,"group",e).fixture.plainUserData.id;b.q.event.emit(f.TQ.ballVSdividerContact,i)}}_beginContact(t){const{ball:e,bonus:i,brick:s,line:a,wall:n}=L;switch(!0){case V.contactContainsGroups(e,n):{const i=V.getFromPair(t.pair,"group",e).fixture.plainUserData.id;b.q.event.emit(f.TQ.ballVSwallContact,i)}break;case V.contactContainsGroups(e,s):{const i=V.getFromPair(t.pair,"group",e),a=V.getFromPair(t.pair,"group",s),n=i.fixture.plainUserData.id,o=a.body.plainUserData.data.fenceId,r=a.fixture.plainUserData.id;b.q.event.emit(f.TQ.ballVSbrickContact,n,o,r)}break;case V.contactContainsGroups(e,a):{const i=V.getFromPair(t.pair,"group",e),s=V.getFromPair(t.pair,"group",a),n=i.fixture.plainUserData.id,o=s.fixture.plainUserData.id;b.q.event.emit(f.TQ.ballVSlineContact,n,o)}break;case V.contactContainsGroups(e,i):{const s=V.getFromPair(t.pair,"group",e),a=V.getFromPair(t.pair,"group",i),n=s.fixture.plainUserData.id,o=a.fixture.plainUserData.id;b.q.event.emit(f.TQ.ballVSbonusContact,n,o)}}}}var me=i(2817);const ye={"brick-hit":i(9728),"fire-ball":i(737),"line-hit":i(5143)},ve={width:50,lifeSpan:160,minimalSquareDistance:10,mapTexture:Z.L.images["trail-data-texture"],alphaMaskTexture:Z.L.images["trail-alpha-mask"],activeAlpha:1,inactiveAlpha:.5,blendMode:H.T$b.ADD};class be{constructor(t){(0,y.Z)(this,"pool",[]),(0,y.Z)(this,"params",void 0),this.params=t}recycle(){this.pool.forEach((t=>this.params.destructorFn(t))),this.pool.length=0}reserve(){const t=this.params.constructorFn();this._placeInPool(t)}spawn(){var t;return 0===(null===(t=this.pool)||void 0===t?void 0:t.length)?this.params.constructorFn(...arguments):this.pool.pop()}despawn(t){this.params.resetFn(t),this._placeInPool(t)}_placeInPool(t){this.pool.push(t)}}i(2994),i(1382),i(8857),i(5688),i(315);var we=i(8301);class fe extends H.rY4{constructor(t){const{width:e,mapTexture:i,alphaMaskTexture:s}=t,a={uTint:new Float32Array(3),uAlpha:1,uTrailWidth:e,uSampler:H.xEZ.from(s),uDataMap:H.xEZ.from(i)};super(H.xEZ.WHITE,{program:new H.$rD(Z.L.shaders.vertex.trail,Z.L.shaders.fragment.trail),uniforms:a})}get color(){return this.uniforms.uTint}set color(t){this.uniforms.uTint=(0,we.hex2rgb)(t)}get width(){return this.uniforms.uTrailWidth}set width(t){this.uniforms.uTrailWidth=t}update(){var t,e,i;super.update(),this.uniforms.uAlpha=(t=this.uniforms.uAlpha,e=this.alpha,(1-(i=.2))*t+i*e)}}i(3161),i(723);class xe extends H.xcF{constructor(t){super(new Float32Array(4*t.length),new Float32Array(4*t.length),new Uint16Array(6*(t.length-1))),(0,y.Z)(this,"points",void 0),this.points=t,this._build(),this.updateAttributes()}update(){}addPoint(t){this.points.push(t),this.updateAttributes()}updatePoints(t){this.points=t,this.updateAttributes()}updateAttributes(){if(this.points.length<2)return;const t=this.points,{length:e}=t,i=this.getBuffer("aVertexPosition"),s=this.getBuffer("aVertexData"),a=this.getIndex(),n=this.getBuffer("aVertexId"),o=this.getBuffer("aTextureCoord"),r=new Float32Array(4*e),h=new Float32Array(8*e),l=new Uint32Array(6*(e-1)),d=new Float32Array(2*e),c=new Float32Array(4*e);for(let e=0;e<t.length;e++){const i=0===e?0:e/(t.length-1);if(c[4*e]=i,c[4*e+1]=0,c[4*e+2]=i,c[4*e+3]=1,r[4*e]=0,r[4*e+1]=0,r[4*e+2]=0,r[4*e+3]=0,d[2*e]=2*e,d[2*e+1]=2*e+1,h[8*e]=t[e].x,h[8*e+1]=t[e].y,h[8*e+4]=t[e].x,h[8*e+5]=t[e].y,null!=t[e+1]?(h[8*e+2]=t[e+1].x,h[8*e+3]=t[e+1].y,h[8*e+6]=t[e+1].x,h[8*e+7]=t[e+1].y):(h[8*e+2]=t[e-1].x,h[8*e+3]=t[e-1].y,h[8*e+6]=t[e-1].x,h[8*e+7]=t[e-1].y),0!==e){const t=2*e,i=t-1,s=i-1,a=2*e+1,n=a-1,o=n-1;l[6*(e-1)]=s,l[6*(e-1)+1]=i,l[6*(e-1)+2]=t,l[6*(e-1)+3]=n,l[6*(e-1)+4]=o,l[6*(e-1)+5]=a}}i.update(r),a.update(l),o.update(c),n.update(d),s.update(h)}_build(){this.addAttribute("aVertexId",new Float32Array(2*this.points.length),1),this.addAttribute("aVertexData",new Float32Array(4*this.points.length*2),4)}}class Se extends H.Kj0{constructor(t,e){super(new xe(t),e),(0,y.Z)(this,"autoUpdate",void 0),(0,y.Z)(this,"points",void 0),(0,y.Z)(this,"debugGr",void 0),this.points=this.geometry.points,this.shader.uniforms.uNodesCount=this.points.length-1,this.autoUpdate=!0}addPoint(t){this.geometry.addPoint((new H.E9j).copyFrom(t)),this.shader.uniforms.uNodesCount=this.points.length-1}update(){null!=this.debugGr&&this.renderPointsDebug()}setDebugger(t){t?null==this.debugGr&&(this.debugGr=new H.TCu,this.addChild(this.debugGr)):(this.removeChild(this.debugGr),this.debugGr=null)}_render(t){const e=this.geometry;this.autoUpdate&&e.update(),super._render(t)}renderPointsDebug(){this.debugGr.clear(),this.debugGr.lineStyle(2,16761538),this.debugGr.moveTo(this.points[0].x,this.points[0].y);for(let t=1;t<this.points.length;t++)this.debugGr.lineTo(this.points[t].x,this.points[t].y);for(let t=0;t<this.points.length;t++)this.debugGr.beginFill(16711714),this.debugGr.drawCircle(this.points[t].x,this.points[t].y,5),this.debugGr.endFill()}}class ke extends Se{constructor(t){const{lifeSpan:e,minimalSquareDistance:i,blendMode:s,inactiveAlpha:a,activeAlpha:n}=t;super([new H.E9j(0,0)],new fe(t)),(0,y.Z)(this,"_object",void 0),(0,y.Z)(this,"_times",[]),(0,y.Z)(this,"_pool",void 0),(0,y.Z)(this,"_lifeSpan",void 0),(0,y.Z)(this,"_minimalSquareDistance",void 0),(0,y.Z)(this,"_inactiveAlpha",void 0),(0,y.Z)(this,"_activeAlpha",void 0),(0,y.Z)(this,"_constructPoint",(()=>new H.E9j(0,0))),(0,y.Z)(this,"_destructPoint",(t=>{})),(0,y.Z)(this,"_resetPoint",(t=>{})),this._lifeSpan=e,this._minimalSquareDistance=i,this.blendMode=s,this._inactiveAlpha=a,this._activeAlpha=n,this._initPool(),this.setInactive()}get lifeSpan(){return this._lifeSpan}set lifeSpan(t){this._lifeSpan=t}get minimalSquareDistance(){return this._minimalSquareDistance}set minimalSquareDistance(t){this._minimalSquareDistance=t}setColor(t){this.material.color=t}setWidth(t){this.material.width=t}update(t){if(null!=this._object&&this.points.length>=2){const{position:e}=this._object,i=this.points[this.points.length-1],s=this.points[this.points.length-2];((t,e)=>{const{x:i,y:s}=t,{x:a,y:n}=e,o=a-i,r=n-s;return o*o+r*r})(this._object.position,s)>this._minimalSquareDistance?this._addPoint(e,t):(i.x=e.x,i.y=e.y,this._updateGeometry())}for(let e=0;e<this._times.length;e++)if(t<this._times[e]+this._lifeSpan){this._removePoints(e-1);break}super.update(t)}attachObject(t){this._object=t,this._resetPoints(),this._addPoint(this._object.position,0),this._addPoint(this._object.position,0)}detachObject(){const t=this._object;return this._object=null,t}setMaterial(t){this.shader=t}setActive(){this.alpha=this._activeAlpha}setInactive(){this.alpha=this._inactiveAlpha}clear(){this._removePoints(this.points.length-2)}reset(){const t=this.detachObject();null!=t&&this.attachObject(t)}_resetPoints(){this.points.length=0,this._times.length=0}_initPool(){this._pool=new be({constructorFn:this._constructPoint,destructorFn:this._destructPoint,resetFn:this._resetPoint})}_addPoint(t,e){const{x:i,y:s}=t,a=this._pool.spawn();a.x=i,a.y=s,this.points.push(a),this._times.push(e),this._updateGeometry()}_removePoint(t){const e=this.points.splice(t,1);this._times.splice(t,1),this._pool.despawn(e[0]),this._updateGeometry()}_removePoints(t){const e=this.points.splice(0,t);this._times.splice(0,t),e.forEach((t=>{this._pool.despawn(t)})),this._updateGeometry()}_updateGeometry(){this.geometry.updateAttributes(),this.shader.uniforms.uNodesCount=this.points.length-1}}class Ce{constructor(t,e){(0,y.Z)(this,"_view",void 0),(0,y.Z)(this,"_body",void 0),(0,y.Z)(this,"_ball",void 0),(0,y.Z)(this,"_hideTween",void 0),(0,y.Z)(this,"_scaleTween",void 0),(0,y.Z)(this,"_trailTween",void 0),(0,y.Z)(this,"_trailEmitter",void 0),(0,y.Z)(this,"_trail",void 0),(0,y.Z)(this,"_lastTint",void 0),this._parent=t,this._model=e,this._view=this._buildView(),this._body=this._buildBody(),this._parent.addChild(this._view)}get uuid(){return this._model.uuid}get view(){return this._view}get body(){return this._body}onUpdate(t,e){this._updateTrailShader(t,e),this._updateTrailEmitter(t,e)}destroy(){var t,e;this._view.destroy(),null===(t=this._scaleTween)||void 0===t||t.kill(),null===(e=this._hideTween)||void 0===e||e.kill(),this._trail.detachObject(),this._trail.destroy(),this._disableBody(),a.l2.physics2D.world.DestroyBody(this._body),O.off(f.bk.postSolve,this._disableBody,this)}disappear(){O.once(f.bk.postSolve,this._disableBody,this),this._hideTween=Ct.ZP.to(this.view,{delay:.2,pixi:{alpha:0,scale:2},duration:.3,universal:!0}),this._disableFeverMode()}show(){this._view.visible=!0,this._body.SetEnabled(!0),this._trail.attachObject(this.view)}hide(){this._view.visible=!1,this._body.SetEnabled(!1)}sync(t){const{p:e}=t;this._view.position.set(u(e.x),u(e.y))}setTheme(t){let{bg:e}=t;this._lastTint=e,this._ball.tint=e,this._trail.setColor(e)}setVelocity(t){this._body.SetLinearVelocity(G(t.x,t.y))}setRadius(t){this._scaleTween=Ct.ZP.to(this._view,(t=>({pixi:{width:2*t,height:2*t},ease:Tt.eJ.easeOut,duration:.3,universal:!0}))(t)).eventCallback("onUpdate",(()=>{this._trail.setWidth(this._view.width)}));const{box2d:e}=a.l2.physics2D,i=this._body.GetFixtureList();e.wrapPointer(e.getPointer(i.GetShape()),e.b2CircleShape).set_m_radius(p(t))}setRadiusTime(t){this._updateCounter(t)}setKillTime(t){this._updateCounter(t)}setFeverMode(t){t?this._enableFeverMode():this._disableFeverMode()}_disableBody(){this.body.SetEnabled(!1)}_enableFeverMode(){var t;this._trail.lifeSpan=400,this._trail.alpha=0===this._ball.tint?.25:.5,null===(t=this._trailTween)||void 0===t||t.kill(),this._ball.texture=H.xEZ.from(Bt.P["fire-ball"]),this._ball.tint=16777215;const e=this._trailEmitter.getBehavior("alpha").list;e.first.value=0,this._trailTween=Ct.ZP.to(e.first,{value:1,duration:.3,universal:!0,onStart:()=>{this._trailEmitter.emit=!0}})}_disableFeverMode(){var t;this._trail.lifeSpan=160,this._trail.alpha=.3,null===(t=this._trailTween)||void 0===t||t.kill(),this._ball.texture=H.xEZ.from(Bt.P.ball),this._ball.tint=this._lastTint;const e=this._trailEmitter.getBehavior("alpha").list;e.first.value=1,this._trailTween=Ct.ZP.to(e.first,{value:0,duration:.4,universal:!0,onComplete:()=>{this._trailEmitter.emit=!1}})}_updateCounter(t){}_buildView(){const{radius:t}=this._model,e=new H.W20;return this._ball=zt(Rt()),this._trailEmitter=It({parent:this._parent,config:ye["fire-ball"]}),this._trailEmitter.fillPool(this._trailEmitter.maxParticles),this._trail=new ke(ve),this._trail.setWidth(2*t),this._parent.addChild(this._trail),e.addChild(this._ball),e}_updateTrailShader(t,e){this._trail.update(t)}_updateTrailEmitter(t,e){const{x:i,y:s}=this._view;this._trailEmitter.update(e/n.wI),this._trailEmitter.updateSpawnPos(i,s)}_buildBody(){const{radius:t,position:e,uuid:i}=this._model,{width:s,height:n}=a.l2.screen.viewBounds,o=J(((t,e,i)=>{const{box2d:s,contactManager:n}=a.l2.physics2D,{filterMap:o}=n;return{userData:{target:i},filters:o.ball,bodyDef:{type:s.b2_dynamicBody,fixedRotation:!0},fixturesDefs:[{shape:N(p(e)),userData:{id:t,group:L.ball},density:1,friction:0,restitution:1,restitutionThreshold:0}]}})(i,t,this));return o.SetTransform(G(p(s*e.x),p(n*e.y)),0),a.l2.physics2D.syncManager.syncBodyTarget(o,!0),o}}class Te{constructor(t,e){(0,y.Z)(this,"_speedTask",void 0),this._balls=t,this._model=e}destroy(){null!=this._speedTask&&a.l2.ticker.cancel(this._speedTask)}onRoomStateUpdate(t){switch(t){case ue.os.play:this._startSpeedTask();break;case ue.os.over:this._stopSpeedTask()}}onRoomStatusUpdate(t){}onVelocityUpdate(t,e){t.setVelocity(e)}_startSpeedTask(){this._speedTask=a.l2.ticker.delay({delay:12e3,loop:!0,callback:()=>{const t=this._balls[0],e=t.body.GetLinearVelocity(),i=n.E9.scalar(e,1+this._model.speedFactor);b.q.event.emit(f.j8.speedTimerTick,t.uuid,i)}})}_stopSpeedTask(){null!=this._speedTask&&a.l2.ticker.cancel(this._speedTask)}}class Pe{constructor(t,e){this._balls=t,this._model=e}destroy(){}onRoomStateUpdate(t){switch(t){case ue.os.tutorial:this._hideBalls();break;case ue.os.counter:this._showBalls();break;case ue.os.over:this._disappearBalls()}}onRoomStatusUpdate(t){}onPlayerIdUpdate(t,e,i){const s=x.h.game.room.playerSet.getPlayerById(e),a=i?Mt.X.getRoomPlayers(s.side).fence.soldier:{bg:Mt.X.getRoomDivider(),text:16777215};t.setTheme(a)}onRadiusUpdate(t,e){t.setRadius(e)}onRadiusTimeUpdate(t,e){t.setRadiusTime(e)}onKillTimeUpdate(t,e){t.setKillTime(e)}_disappearBalls(){this._balls.forEach((t=>t.disappear()))}_hideBalls(){this._balls.forEach((t=>t.hide()))}_showBalls(){this._balls.forEach((t=>t.show()))}}class Ze{constructor(t,e){(0,y.Z)(this,"_balls",[]),(0,y.Z)(this,"_ballsSpeedManager",void 0),(0,y.Z)(this,"_ballsVisualsManager",void 0),this._parent=t,this._model=e,this._createBall(this._model.mainBall),this._ballsSpeedManager=new Te(this._balls,this._model),this._ballsVisualsManager=new Pe(this._balls,this._model),b.q.event.on(w.xh.ballsUpdate,this._onBallsUpdate,this),b.q.event.on(w.CA.velocityUpdate,this._onBallVelocityUpdate,this),b.q.event.on(w.CA.radiusUpdate,this._onBallRadiusUpdate,this),b.q.event.on(w.CA.killTimeUpdate,this._onBallKillTimeUpdate,this),b.q.event.on(w.CA.radiusTimeUpdate,this._onBallRadiusTimeUpdate,this),b.q.event.on(w.CA.playerIdUpdate,this._onBallPlayerIdUpdate,this),b.q.event.on(w.CA.feverModeUpdate,this._onBallFeverModeUpdate,this)}get uuid(){return this._model.uuid}get mainBall(){return this._balls[0]}onDestroy(){b.q.event.removeListenersOf(this),this._ballsSpeedManager.destroy(),this._ballsSpeedManager=null,this._ballsVisualsManager.destroy(),this._ballsVisualsManager=null,this._balls.forEach((t=>t.destroy())),this._balls.length=0,this._balls=null}onResize(t){}onUpdate(t,e){var i;null===(i=this._balls)||void 0===i||i.forEach((i=>i.onUpdate(t,e)))}getBallById(t){return this._balls.find((e=>e.uuid===t))}onRoomStateUpdate(t){this._ballsSpeedManager.onRoomStateUpdate(t),this._ballsVisualsManager.onRoomStateUpdate(t)}onRoomStatusUpdate(t){this._ballsSpeedManager.onRoomStatusUpdate(t),this._ballsVisualsManager.onRoomStatusUpdate(t)}_onBallsUpdate(t){const e=(0,me.Z)(t,"uuid",this._balls,"uuid"),i=(0,me.Z)(this._balls,"uuid",t,"uuid");this._createBalls(e),this._destroyBalls(i)}_onBallVelocityUpdate(t,e,i){const s=this.getBallById(i);this._ballsSpeedManager.onVelocityUpdate(s,t)}_onBallRadiusUpdate(t,e,i){const s=this.getBallById(i);this._ballsVisualsManager.onRadiusUpdate(s,t)}_onBallRadiusTimeUpdate(t,e,i){const s=this.getBallById(i);this._ballsVisualsManager.onRadiusTimeUpdate(s,t)}_onBallKillTimeUpdate(t,e,i){const s=this.getBallById(i);this._ballsVisualsManager.onKillTimeUpdate(s,t)}_onBallPlayerIdUpdate(t,e,i){const s=this.getBallById(i);this._ballsVisualsManager.onPlayerIdUpdate(s,t,s.uuid===this.mainBall.uuid)}_onBallFeverModeUpdate(t,e,i){const s=this.getBallById(i);null==s||s.setFeverMode(t)}_createBalls(t){t.forEach((t=>this._createBall(t)))}_destroyBalls(t){t.forEach((t=>this._destroyBall(t)))}_createBall(t){const e=new Ce(this._parent,t);e.show(),this._balls.push(e),b.q.event.emit(f.j8.ballsUpdate,this._balls)}_destroyBall(t){this._balls.splice(this._balls.indexOf(t),1),t.destroy()}}var De=i(5750);const Me=new Map([[s.Do.shield,{radius:40,frame:Bt.P["bonus-shield"]}],[s.Do.bigBall,{radius:46,frame:Bt.P["bonus-big-ball"]}],[s.Do.newBall,{radius:46,frame:Bt.P["bonus-new-ball"]}]]);class Be extends H.W20{constructor(t){super(),(0,y.Z)(this,"_body",void 0),(0,y.Z)(this,"_actionTween",void 0),this._model=t,b.q.event.on(w.mr.stateUpdate,this._onBonusStateUpdate,this)}destroy(){b.q.event.removeListenersOf(this),this._body.SetEnabled(!1),a.l2.physics2D.world.DestroyBody(this._body),this._killActionTween(),super.destroy()}_onBonusStateUpdate(t,e,i){switch(t){case De.T.init:this._build();break;case De.T.show:this._show();break;case De.T.hide:this._detachBody(),this._hide();break;case De.T.idle:this._attachBody();break;case De.T.active:this._disable()}}_build(){const{frame:t,radius:e}=Me.get(this._model.type);this._buildView(t),this._buildBody(e)}_show(){this._killActionTween(),this._actionTween=Ct.ZP.from(this,{pixi:{alpha:0},duration:.15,repeat:2}).eventCallback("onStart",(()=>{this.visible=!0})).eventCallback("onComplete",(()=>{b.q.event.emit(f.yc.showComplete,this._model.uuid)}))}_hide(){this._killActionTween(),this._actionTween=Ct.ZP.to(this,{pixi:{alpha:0},duration:.15,repeat:2}).eventCallback("onComplete",(()=>{b.q.event.emit(f.yc.hideComplete,this._model.uuid)}))}_disable(){this._killActionTween(),this._actionTween=Ct.ZP.to(this,{pixi:{scale:1.2,alpha:.8},duration:.2,ease:Tt.eJ.easeOut}).eventCallback("onComplete",(()=>{this.visible=!1})),this._detachBody()}_killActionTween(){var t;null===(t=this._actionTween)||void 0===t||t.kill()}_buildView(t){const{width:e,height:i}=a.l2.screen.viewBounds,{position:s}=this._model,n=zt({texture:Bt.P["bonus-glow"]}),o=zt({texture:t});this.addChild(n,o),this.position.set(s.x*e,s.y*i),this.visible=!1}_buildBody(t){this._body=J(((t,e,i)=>{const{box2d:s,contactManager:n}=a.l2.physics2D,{filterMap:o}=n;return{userData:{},filters:o.bonus,bodyDef:{type:s.b2_staticBody,position:i},fixturesDefs:[{shape:N(e),userData:{id:t,group:L.bonus},isSensor:!0}]}})(this._model.uuid,p(t),G(p(this.position.x),p(this.position.y)))),this._body.SetEnabled(!1)}_attachBody(){this._body.SetEnabled(!0)}_detachBody(){a.l2.ticker.post((()=>{this._body.SetEnabled(!1)}))}}class Ue{constructor(t,e){(0,y.Z)(this,"_bonus",void 0),this._parent=t,this._model=e,b.q.event.on(w.qN.bonusUpdate,this._onBonusUpdate,this)}onDestroy(){this._destroyBonus(),b.q.event.removeListenersOf(this)}onResize(t){}onUpdate(t,e){}onRoomStateUpdate(t){}onRoomStatusUpdate(t){}_onBonusUpdate(t){null!=t?this._createBonus(t):this._destroyBonus()}_createBonus(t){this._bonus=new Be(t),this._parent.addChild(this._bonus)}_destroyBonus(){var t;null===(t=this._bonus)||void 0===t||t.destroy(),this._bonus=null}}class Re extends H.Xz2{constructor(){super(" ",{fontName:Nt.HelveticaBold,fontSize:100}),this.anchor.set(.5,.6)}setText(t,e,i){var s;this.fontSize=e,this.text=t,this.onStart(),Ct.ZP.to(this,(s=this,{pixi:{alpha:0,fontSize:0},duration:.9,ease:Tt.Yv.easeIn,callbackScope:s,universal:!0})).eventCallback("onStart",this.onTickStart).eventCallback("onComplete",this.onTickComplete,[i])}onTickStart(){}onTickComplete(t){t&&this.onComplete()}onStart(){this.visible=!0,this.alpha=1}onComplete(){this.visible=!1,this.alpha=0}}const Ee=[{text:"go",size:300},{text:"1",size:600},{text:"2",size:600},{text:"well-done",size:160}];class Le extends Re{constructor(t){super(),this._model=t,b.q.event.on(w.mK.remainingUpdate,this._onTick,this)}onDestroy(){b.q.event.removeListenersOf(this),super.destroy()}onResize(t){const{x:e,y:i}=g(t);this.position.set(e,i)}onTickStart(){super.onTickStart()}onTickComplete(t){super.onTickComplete(t)}onStart(){super.onStart(),this._applyTheme()}onComplete(){super.onComplete(),this.visible=!1,b.q.event.emit(f.DX.complete)}_onTick(t){const{text:e,size:i}=Ee[t];this.setText(a.l2.localization.get(e),i,0===t)}_applyTheme(){const{playerId:t}=x.h.game.room.ballSet.mainBall,e=x.h.game.room.playerSet.getPlayerById(t),i=Mt.X.getRoomPlayers(e.side);this.tint=i.fence.soldier.bg}}class Fe extends H.W20{constructor(t){super(),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_glow",void 0),(0,y.Z)(this,"_playerMask",void 0),(0,y.Z)(this,"_playerProgress",void 0),(0,y.Z)(this,"_opponentProgress",void 0),(0,y.Z)(this,"_blinkTween",void 0),(0,y.Z)(this,"_progressTween",void 0),(0,y.Z)(this,"_highlightTween",void 0),this._model=t,this._build(),this._setProgress(this._model.progress),b.q.event.on(w.o9.progressUpdate,this._onProgressUpdate,this),b.q.event.on(w.o9.activeUpdate,this._onActiveUpdate,this)}destroy(t){b.q.event.removeListenersOf(this),this._highlightTween.kill(),this._blinkTween.kill(),this._progressTween.kill(),super.destroy(t)}onResize(t){const{x:e,y:i,width:s,height:a}=t;this.position.set(e+s-55,i+a/2)}disable(){b.q.event.removeListenersOf(this),this._stopHighlight()}applyTheme(t,e){this._playerProgress.tint=t,this._opponentProgress.tint=e}_onProgressUpdate(t,e){this._setProgress(t,e)}_onActiveUpdate(t){t?this._startHighlight():this._stopHighlight()}_startHighlight(){this._highlightTween.invalidate(),this._highlightTween.restart()}_stopHighlight(){this._glow.alpha=1,this._glow.visible=!1,this._highlightTween.kill()}_setProgress(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const{x:i,y:s,width:a,height:n}=this._bg.getLocalBounds(),o={height:-n*e};this._progressTween=Ct.ZP.to(o,{height:-n*t,onUpdate:()=>{this._updateProgressMask(i,s+n,a,o.height)}}),this._blinkTween.invalidate(),this._blinkTween.restart()}_updateProgressMask(t,e,i,s){this._playerMask.clear(),this._playerMask.beginFill(0,.3),this._playerMask.drawRect(t,e,i,s),this._playerMask.endFill()}_build(){this._bg=zt({texture:Bt.P["fever-bg"]}),this._glow=zt({texture:Bt.P["fever-bg-glow"]}),this._glow.visible=!1,this._opponentProgress=this._buildProgress(),this._playerProgress=this._buildProgress(),this._playerMask=new H.TCu,this._playerProgress.mask=this._playerMask,this._blinkTween=Ct.ZP.to(this,{pixi:{scale:1.05},yoyo:!0,repeat:1,duration:.04,universal:!0,ease:Tt.Yv.easeInOut}),this._blinkTween.totalProgress(0).kill(),this._highlightTween=Ct.ZP.to(this._glow,{pixi:{alpha:0},yoyo:!0,repeat:-1,duration:.5,universal:!0,ease:Tt.Yv.easeInOut}),this._highlightTween.totalProgress(0).kill(),this._highlightTween.eventCallback("onStart",(()=>{this._glow.alpha=1,this._glow.visible=!0})).eventCallback("onComplete",(()=>{this._glow.alpha=1,this._glow.visible=!1})),this.addChild(this._glow,this._bg,this._opponentProgress,this._playerProgress,this._playerMask)}_buildProgress(){return zt({texture:Bt.P["fever-fill"]})}}i(9992),i(9509);var Ae=i(409),ze=i(3089),Ie=i(5285);class Oe{constructor(t){(0,y.Z)(this,"_gr",void 0),this._gr=new H.TCu,t.addChild(this._gr)}clear(){this._gr.moveTo(0,0),this._gr.clear()}move(t){this._gr.moveTo(u(t.x),u(t.y))}drawDefence(t){const e=[];if(t.forEach((t=>{e.push(t.from,t.to)})),0!==e.length){this._gr.moveTo(u(e[0].x),u(e[0].y));for(let t=0;t<e.length;t++){const i=e[t];this._gr.lineStyle(6,16777215,0),this._gr.lineTo(u(i.x),u(i.y)),this._gr.beginFill(0,0),this._gr.drawCircle(u(i.x),u(i.y),10)}}}drawAttack(t){const{from:e,to:i,target:s}=t,a=n.E9.getPointOn(e,i,.5);this._gr.moveTo(e.x,e.y),this._gr.beginFill(16711680,0),this._gr.drawCircle(a.x,a.y,20),this._gr.lineStyle(6,16777215,0),this._gr.lineTo(i.x,i.y),this._gr.lineStyle(6,65280,0),this._gr.moveTo(a.x,a.y),this._gr.lineTo(u(s.x),u(s.y))}}class qe{constructor(t,e){(0,y.Z)(this,"_attackRayCastCallback",void 0),(0,y.Z)(this,"_rayDrawManager",void 0),(0,y.Z)(this,"_area",void 0),(0,y.Z)(this,"_attackPoint",void 0),(0,y.Z)(this,"_attackRayCastReporter",((t,e,i,s)=>{var n;const{box2d:o}=a.l2.physics2D;switch(null===(n=o.wrapPointer(t,o.b2Fixture).plainUserData)||void 0===n?void 0:n.group){case L.brick:case L.wall:case L.divider:{const t=o.wrapPointer(e,o.b2Vec2);this._attackPoint={x:t.x,y:t.y}}return s}return-1})),this._attackRayCastCallback=new a.l2.physics2D.box2d.JSRayCastCallback,this._attackRayCastCallback.ReportFixture=this._attackRayCastReporter,this._rayDrawManager=new Oe(t),this._area=e}onDestroy(){}analyzeAttack(t,e,i){const{from:s,to:a,fraction:o}=e,r=n.E9.getPointOn(s,a,o),h=t.GetPosition(),l=n.E9.angle(s,a),d=n.E9.angle(r,h),c=(0,Ie.Z)(2.5,3.5),_=n.E9.distance(s,a)*o,u=.1*Math.pow(i.logic,-2),p=l-(l-d)/2+(0,Ie.Z)(-u,u),g=c/i.logic*.5,m={x:(0,Ie.Z)(-g,g),y:0};n.E9.scalar(r,n.rL).x>this._area.width/2&&(m.x*=-1);const y=n.E9.add(r,m),v={from:n.E9.moveBy(y,p,.5*c),to:n.E9.moveBy(y,p,.5*-c),target:h,distance:_};return this._analyzeAttackResult(v)}_analyzeAttackResult(t){const{world:e}=a.l2.physics2D,{from:i,to:s}=t,o=n.E9.getPointOn(i,s,.5),r=G(o.x,o.y),h=G(i.x,i.y),l=G(s.x,s.y);return this._attackPoint={x:h.x,y:h.y},e.RayCast(this._attackRayCastCallback,r,h),t.from={x:Math.round(u(this._attackPoint.x)),y:Math.round(u(this._attackPoint.y))},this._attackPoint={x:l.x,y:l.y},e.RayCast(this._attackRayCastCallback,r,l),t.to={x:Math.round(u(this._attackPoint.x)),y:Math.round(u(this._attackPoint.y))},this._rayDrawManager.clear(),this._rayDrawManager.drawAttack(t),t}}class Ve{constructor(t,e,i,s){this.point=t,this.normal=e,this.fraction=i,this.group=s}}class He{constructor(t,e){(0,y.Z)(this,"_defenceRayCastCallback",void 0),(0,y.Z)(this,"_rayDrawManager",void 0),(0,y.Z)(this,"_defenceRayData",void 0),(0,y.Z)(this,"_defenceRayCastReporter",((t,e,i,s)=>{var o;const{box2d:r}=a.l2.physics2D,h=null===(o=r.wrapPointer(t,r.b2Fixture).plainUserData)||void 0===o?void 0:o.group;switch(h){case L.brick:case L.wall:case L.divider:{const t=r.wrapPointer(e,r.b2Vec2),a=r.wrapPointer(i,r.b2Vec2);this._defenceRayData=new Ve(new n.E9(t.x,t.y),new n.E9(a.x,a.y),s,h)}return s}return-1})),this._defenceRayCastCallback=new a.l2.physics2D.box2d.JSRayCastCallback,this._defenceRayCastCallback.ReportFixture=this._defenceRayCastReporter,this._rayDrawManager=new Oe(t)}onDestroy(){}analyzeDefence(t,e){const{x:i,y:s}=t.GetPosition(),{x:a,y:o}=t.GetLinearVelocity(),r={x:i,y:s},h={x:i+a,y:s+o},l=n.E9.angle(r,h),d=n.E9.moveBy(r,l,100),c=G(r.x,r.y),_=G(d.x,d.y),u=this._reflectRay(c,_,[],e);return this._rayDrawManager.clear(),this._rayDrawManager.drawDefence(u),this._analyzeDefenceResult(u,e)}_analyzeDefenceResult(t,e){const{0:i,1:s}=t,a=n.E9.distance(i.from,i.to),o=n.E9.distance(s.from,s.to);return i.fraction=.5,s.fraction=.5,i.group===L.brick?i:i.group===L.wall&&s.group===L.brick?o/a<.6?i:s:i.group===L.wall&&s.group===L.wall?a>o?i:s:i.group===L.wall&&s.group===L.divider?i:t[0]}_reflectRay(t,e,i,s){const{world:o}=a.l2.physics2D;if(o.RayCast(this._defenceRayCastCallback,t,e),2===i.length)return i;const{point:r,normal:h,group:l,fraction:d}=this._defenceRayData,c=n.E9.subtract(e,r),_=n.E9.scalar(h,n.E9.dot(c,h)),{x:u,y:p}=n.E9.subtract(e,n.E9.scalar(_,2));return i.push({from:t,to:r,group:l,fraction:d}),this._reflectRay(G(r.x,r.y),G(u,p),i,s)}}class Ge{constructor(){(0,y.Z)(this,"_rematchTask",void 0)}onDestroy(){this._stopRematchTask()}onGameModelStateUpdate(t){if(t===Pt.D.result)this._startRematchRequest()}onResultStatusUpdate(t){switch(t){case Qt.$.playerRematchRequest:this._onPlayerRematchRequest();break;case Qt.$.cancel:this._stopRematchTask()}}_startRematchRequest(){this._startRematchTask((0,Ie.Z)(1e3,2e3,!1),.7,(()=>{b.q.event.emit(f.OK.rematchRequest)}),(()=>{}))}_onPlayerRematchRequest(){this._startRematchTask((0,Ie.Z)(1e3,2e3,!1),.7,(()=>{b.q.event.emit(f.OK.rematchApprove)}),(()=>{b.q.event.emit(f.OK.rematchReject)}))}_stopRematchTask(){null!=this._rematchTask&&a.l2.ticker.cancel(this._rematchTask)}_startRematchTask(t,e,i,s){this._stopRematchTask(),this._rematchTask=a.l2.ticker.delay({delay:t,callback:()=>{m(e)?i():s()}})}}class je{constructor(t){this.allowed=t}onDestroy(){}hitTest(t){const{x:e,y:i}=t;if(!this.allowed.contains(e,i))return!1;const{world:s,box2d:n}=a.l2.physics2D,o=G(p(e),p(i));for(let t=s.GetBodyList();0!==n.getPointer(t);t=t.GetNext())if(t.IsEnabled())for(let e=t.GetFixtureList();0!==n.getPointer(e);e=e.GetNext()){var r;const t=null===(r=e.plainUserData)||void 0===r?void 0:r.group;if((t===L.wall||t===L.brick)&&e.TestPoint(o))return!1}return!0}}class Ne extends(I()){constructor(t){super(),(0,y.Z)(this,"startPoint",new n.E9),(0,y.Z)(this,"endPoint",new n.E9),this.view=t}startDraw(t){this.startPoint.copyFrom(t)}endDraw(t){this.endPoint.copyFrom(t)}resetDraw(){this.startPoint.set(0,0),this.endPoint.set(0,0)}}class We extends Ne{constructor(t){super(t),(0,y.Z)(this,"_rayCastCallback",void 0),(0,y.Z)(this,"_rayCastReporter",((t,e,i,s)=>{var n;const{box2d:o}=a.l2.physics2D,r=o.wrapPointer(e,o.b2Vec2),h={x:u(r.x),y:u(r.y)};switch(null===(n=o.wrapPointer(t,o.b2Fixture).plainUserData)||void 0===n?void 0:n.group){case L.wall:case L.brick:case L.divider:return this.endPoint.copyFrom(h),s;default:return-1}})),this._rayCastCallback=new a.l2.physics2D.box2d.JSRayCastCallback,this._rayCastCallback.ReportFixture=this._rayCastReporter}startDraw(t){super.startDraw(t),this.view.startDraw(this.startPoint),b.q.event.emit(f.oo.drawStart,this.view.uuid)}updateDraw(t){this.view.updateDraw(t),this._checkForIntersectionLimits(this.startPoint,t),this._checkForLengthLimits(this.startPoint,t),this._checkForLimitsSummary()}endDraw(t){super.endDraw(t),this.view.endDraw(this.endPoint),b.q.event.emit(f.oo.drawEnd,this.view.uuid)}resetDraw(){super.resetDraw(),this.view.resetDraw()}disappear(){this.view.disappear()}_checkForIntersectionLimits(t,e){var i;const s=G(p(t.x),p(t.y)),n=G(p(e.x),p(e.y));null===(i=a.l2.physics2D)||void 0===i||i.world.RayCast(this._rayCastCallback,s,n)}_checkForLengthLimits(t,e){const i=this.view.maxLength;if(n.E9.distance(t,e)>i){const s=n.E9.angle(t,e),a=Math.sin(s)*i,o=Math.cos(s)*i,r={x:t.x+o,y:t.y+a};if(n.E9.isZero(this.endPoint))return void this.endPoint.copyFrom(r);const h=n.E9.distance(t,this.endPoint);n.E9.distance(t,r)<h&&this.endPoint.copyFrom(r)}}_checkForLimitsSummary(){!n.E9.isZero(this.endPoint)&&this.emit(We.events.lineLimit,this.endPoint)}}(0,y.Z)(We,"events",{lineLimit:"LineMaxLimitStrategyLineLimit"});class Je extends Ne{constructor(t){super(t)}startDraw(t){super.startDraw(t)}updateDraw(t){n.E9.distance(this.startPoint,t)>this.view.minLength&&this.emit(Je.events.limitReached,this.startPoint)}endDraw(t){super.endDraw(t)}resetDraw(){super.resetDraw()}disappear(){}}(0,y.Z)(Je,"events",{limitReached:"LineMinLimitStrategyLimitReached"});var Xe=i(9397);class $e extends H.Xz2{constructor(t){super(" ",t.text),(0,y.Z)(this,"_hideTween",void 0),this.config=t,this.anchor.set(.5),this._hideTween=this._getHideTween()}updateTheme(t){this.tint=t}notify(t){return!0!==this._hideTween.data.active&&(this.text=a.l2.localization.get(t),this._startDisappearing(),!0)}_startDisappearing(){this.alpha=1,this.visible=!0,this._hideTween.invalidate(),this._hideTween.restart(!0),this._hideTween.data.active=!0}_getHideTween(){const t=Ct.ZP.to(this,this.config.tween).eventCallback("onComplete",(()=>{t.data.active=!1,this.visible=!1}));return t}}class Ye extends $e{constructor(){super({text:{fontName:Nt.HelveticaBold,align:"center",fontSize:44},tween:{pixi:{alpha:0},delay:1,duration:.5,data:{active:!1},ease:Tt.Yv.easeOut}})}}class Qe extends z.EventEmitter{constructor(t,e){super(),(0,y.Z)(this,"_line",void 0),(0,y.Z)(this,"_body",void 0),(0,y.Z)(this,"_cooldown",void 0),(0,y.Z)(this,"_emitter",void 0),(0,y.Z)(this,"_notification",void 0),(0,y.Z)(this,"_startPoint",new n.E9),(0,y.Z)(this,"_endPoint",new n.E9),this._parent=t,this._model=e,this._buildLine(),this._buildBody(),this._buildEmitter(),this._buildCooldown(),this._buildNotification()}get uuid(){return this._model.uuid}get thickness(){return this._model.thickness}get minLength(){return this._model.minLength}get maxLength(){return this._model.maxLength}destroy(){this._body.SetEnabled(!1),a.l2.physics2D.world.DestroyBody(this._body),this._line.destroy(),this._emitter.destroy(),this._cooldown.kill()}updateTheme(t){let{color:e}=t;this._line.tint=e,this._notification.updateTheme(e)}startDraw(t){this._startPoint.copyFrom(t),this._endPoint.copyFrom(t),this._line.position.set(t.x,t.y)}updateDraw(t){const{distance:e,angle:i}=this._analyzeLineTransform(this._startPoint,t);this._line.width=e,this._line.rotation=i,this._endPoint.copyFrom(t),this._attachBody()}endDraw(t){this._endPoint.copyFrom(t),this.updateDraw(t),this._startCooldown(),this._attachBody()}resetDraw(){this._detachBody(),this._cooldown.kill(),this._line.width=0,this._line.alpha=1}disappear(){this._cooldown.kill();const t=(new n.E9).copyFrom(this._startPoint),{distance:e,angle:i}=this._analyzeLineTransform(this._startPoint,this._endPoint);this._playEmitter(t,e,i)}notifyProtect(){if(m(.1)){const t=[vt["protect-success-01"],vt["protect-success-02"],vt["protect-success-03"],vt["protect-success-04"]];this._notification.notify((0,Xe.Z)(t))&&this._notification.position.copyFrom(n.E9.getPointOn(this._startPoint,this._endPoint,.5))}}_playEmitter(t,e,i){this._emitter.resetPositionTracking(),this._emitter.rotate(i),this._emitter.updateSpawnPos(t.x,t.y),this._emitter.playOnce(),this._emitter.frequency=1/e;this._emitter.getBehavior("spawnShape").shape.w=e;{const t=this._emitter.getBehavior("color"),e=(0,n.Zu)(this._line.tint),i=t.list.first,s=t.list.first.next;i.value=s.value=e}}_startCooldown(){this._cooldown.invalidate(),this._cooldown.restart(!0)}_onCooldownComplete(){this.emit(Qe.events.cooldownComplete)}_attachBody(){this._body.SetEnabled(!0),this._shapeBodyFixture(this._startPoint,this._endPoint)}_detachBody(){a.l2.ticker.post((()=>this._body.SetEnabled(!1)))}_shapeBodyFixture(t,e){const{box2d:i}=a.l2.physics2D,s=this._body.GetFixtureList(),n=s.plainUserData,o=s.GetFilterData();this._body.DestroyFixture(s);const r=new i.b2FixtureDef;r.shape=j(G(p(t.x),p(t.y)),G(p(e.x),p(e.y))),r.filter=o,r.userData=n,this._body.CreateFixture(r)}_analyzeLineTransform(t,e){return{distance:n.E9.distance(t,e),angle:n.E9.angle(t,e)}}_buildLine(){this._line=zt({texture:Bt.P["white-square"]}),this._line.anchor.set(0,.5),this._line.height=this.thickness,this._line.width=0,this._parent.addChild(this._line)}_buildBody(){this._body=J((t=>{const{box2d:e,contactManager:i}=a.l2.physics2D,{filterMap:s}=i;return{userData:{},filters:s.line,bodyDef:{type:e.b2_staticBody},fixturesDefs:[{shape:j(G(-1,-1),G(-1,-1)),userData:{id:t,group:L.line}}]}})(this.uuid))}_buildEmitter(){this._emitter=It({parent:this._parent,config:ye["line-hit"]}),this._emitter.fillPool(20)}_buildCooldown(){var t;this._cooldown=Ct.ZP.to(this._line,(t=this,{alpha:0,delay:1,yoyo:!0,repeat:2,ease:Tt.Yv.easeOut,duration:.08,paused:!0,callbackScope:t,universal:!0})),this._cooldown.eventCallback("onComplete",this._onCooldownComplete)}_buildNotification(){this._notification=new Ye,this._parent.addChild(this._notification)}}(0,y.Z)(Qe,"events",{cooldownComplete:"LineViewCooldownComplete"});class Ke extends z.EventEmitter{constructor(t){super(),(0,y.Z)(this,"_minLimitStrategy",void 0),(0,y.Z)(this,"_drawStrategy",void 0),(0,y.Z)(this,"_strategy",void 0),this._view=t,this._view.on(Qe.events.cooldownComplete,this._onCooldownComplete,this),this._drawStrategy=new We(this._view),this._minLimitStrategy=new Je(this._view),this._drawStrategy.on(We.events.lineLimit,this._onLineMaxLimitReached,this),this._minLimitStrategy.on(Je.events.limitReached,this._onLineMinLimitReached,this)}onDestroy(){}onStateUpdate(t,e){switch(t){case ze.V.idle:this._onDrawReset();break;case ze.V.hit:this._strategy.disappear();case ze.V.drawStart:case ze.V.drawEnd:}}startDraw(t){this._strategy=this._minLimitStrategy,this._strategy.startDraw(t)}updateDraw(t){this._strategy.updateDraw(t)}endDraw(t){this._strategy.endDraw(t)}_onLineMinLimitReached(t){this._strategy=this._drawStrategy,this._strategy.startDraw(t)}_onLineMaxLimitReached(t){this.emit(Ke.events.lineLimit,t)}_onDrawReset(){this._minLimitStrategy.resetDraw(),this._drawStrategy.resetDraw()}_onCooldownComplete(){b.q.event.emit(f.oo.cooldownComplete,this._view.uuid)}}(0,y.Z)(Ke,"events",{lineLimit:"LineManagerLineLimit"});class ti{constructor(t){(0,y.Z)(this,"lineManager",void 0),(0,y.Z)(this,"areaManager",void 0),(0,y.Z)(this,"target",void 0),this.view=t,this.lineManager=new Ke(this.view.line),this.areaManager=new je(this.view.area),this.lineManager.on(Ke.events.lineLimit,this.onLineLimit,this),b.q.event.on(w.it.stateUpdate,this._onLineStateUpdate,this)}onDestroy(){b.q.event.removeListenersOf(this),this.lineManager.onDestroy(),this.areaManager.onDestroy()}setTarget(t){this.target=t}startDraw(t){return!!this.areaManager.hitTest(t)&&(this.lineManager.startDraw(t),!0)}updateDraw(t){this.lineManager.updateDraw(t)}endDraw(t){this.lineManager.endDraw(t)}_onLineStateUpdate(t,e,i){this.view.line.uuid===i&&(this.lineManager.onStateUpdate(t,e),this.onLineStateUpdate(t,e))}}class ei extends ti{constructor(t,e){super(t),(0,y.Z)(this,"_ball",void 0),(0,y.Z)(this,"_idleTimer",void 0),(0,y.Z)(this,"_cooldownTimer",void 0),(0,y.Z)(this,"_drawTween",void 0),(0,y.Z)(this,"_lineState",void 0),(0,y.Z)(this,"_coolDown",void 0),(0,y.Z)(this,"_enabled",void 0),(0,y.Z)(this,"_rematchManager",void 0),(0,y.Z)(this,"_defenceManager",void 0),(0,y.Z)(this,"_attackManager",void 0),(0,y.Z)(this,"_accuracy",void 0),this._accuracy=e,this._rematchManager=new Ge,this._defenceManager=new He(this.view.fence.parent,this.view.area),this._attackManager=new qe(this.view.fence.parent,this.view.area),b.q.event.on(w.N.stateUpdate,this._onGameModelStateUpdate,this),b.q.event.on(w.d5.statusUpdate,this._onResultStatusUpdate,this),b.q.event.once(f.j8.ballsUpdate,this._onBallsUpdate,this),b.q.event.on(f.TQ.ballVSdividerContact,this._onAreaContact,this)}onDestroy(){b.q.event.removeListenersOf(this),this._rematchManager.onDestroy(),this._defenceManager.onDestroy(),this._attackManager.onDestroy(),this._stopIdleTimer(),this._stopCooldownTimer(),super.onDestroy()}onRoomStateUpdate(t){switch(t){case ue.os.play:this._lineState=ze.V.idle,this._enabled=!0;break;case ue.os.over:this._enabled=!1}}onLineStateUpdate(t,e){switch(this._lineState=t,t){case ze.V.idle:this._startIdleTimer(),this._startCooldownTimer();break;case ze.V.hit:this._drawTween.kill(),this._startCooldownTimer();break;default:this._stopIdleTimer()}}onLineLimit(){const{x:t,y:e}=this._drawTween.data;this._drawTween.kill(),this.endDraw({x:t,y:e})}_onBallsUpdate(t){this._ball=t[0]}_onGameModelStateUpdate(t){this._rematchManager.onGameModelStateUpdate(t)}_onResultStatusUpdate(t){this._rematchManager.onResultStatusUpdate(t)}_onAreaContact(t){const{x:e,y:i}=this._ball.body.GetLinearVelocity(),s=Math.atan2(i,e),a=Math.sign(s)!==this.view.side,n=t!==this._ball.uuid;a?this._stopIdleTimer():n||this._startDefence()||this._startIdleTimer()}_startDefence(){if(!this._enabled)return!1;if(this._coolDown)return!1;if(this._lineState!==ze.V.idle)return!1;if(Math.random()<this._accuracy.miss)return!1;const t=this._defenceManager.analyzeDefence(this._ball.body,this._accuracy),e=this._attackManager.analyzeAttack(this.target.castle.body,t,this._accuracy);let{distance:i,from:s,to:a}=e;if(i<.5)return!1;const n=(0,Ae.Z)([s,a]);return this.areaManager.hitTest(n[0])||n.reverse(),s=n[0],a=n[1],this._drawLine(n[0],n[1],i),!0}_startIdleTimer(){this._stopIdleTimer(),this._idleTimer=a.l2.ticker.delay({delay:1e3+2e3*this._accuracy.miss,callback:()=>{b.q.event.once(f.TQ.ballVSwallContact,(t=>{if(t!==this._ball.uuid)return;const{x:e,y:i}=this._ball.body.GetPosition(),{x:s,y:a}=this._ball.body.GetLinearVelocity(),n=0===s?0:Math.abs(Math.tan(a/s));this.areaManager.allowed.contains(u(e),u(i))&&(n>.3||(this._startDefence(),this._startIdleTimer()))}))}})}_stopIdleTimer(){null!=this._idleTimer&&a.l2.ticker.cancel(this._idleTimer)}_startCooldownTimer(){this._stopCooldownTimer(),this._coolDown=!0,this._cooldownTimer=a.l2.ticker.delay({delay:1e3+3e3*this._accuracy.miss,callback:()=>{this._coolDown=!1}})}_stopCooldownTimer(){null!=this._cooldownTimer&&a.l2.ticker.cancel(this._cooldownTimer)}_drawLine(t,e,i){if(this.startDraw(t)){const{x:i,y:s}=this._ball.body.GetLinearVelocity(),a=Math.hypot(i,s),n=Math.log(a)/(10*a)/.15,o={x:t.x,y:t.y};this._drawTween=Ct.ZP.to(o,{x:e.x,y:e.y,delay:.6*n,duration:.4*n,data:o,ease:Tt.bJ.easeIn,onUpdate:()=>{this.updateDraw(o)},onComplete:()=>{this.endDraw(o)}})}}}class ii extends z.EventEmitter{constructor(){var t;super(),(0,y.Z)(this,"_input",void 0),(0,y.Z)(this,"_point",void 0),(0,y.Z)(this,"_enabled",void 0),this._enabled=!0,this._point=new n.E9,this._input=null===(t=a.l2.pixi)||void 0===t?void 0:t.renderer.plugins.interaction,this._input.on("pointerdown",this._onDown,this)}setEnabled(t){this._enabled=t,t||(this._input.off("pointermove",this._onMove,this),this._input.off("pointerup",this._onUp,this))}reset(){this._input.off("pointerup",this._onUp,this),this._input.off("pointermove",this._onMove,this)}endMove(t){this.reset(),this.emit(ii.events.onUp,null!=t?t:this._point)}_onDown(t){if(!this._enabled)return;this._input.on("pointermove",this._onMove,this),this._input.once("pointerup",this._onUp,this);const e=n.E9.scalar(t.data.global,1/a.l2.screen.viewScale);this.emit(ii.events.onDown,this._point.copyFrom(e))}_onMove(t){const e=n.E9.scalar(t.data.global,1/a.l2.screen.viewScale);this.emit(ii.events.onMove,this._point.copyFrom(e))}_onUp(t){this.reset();const e=n.E9.scalar(t.data.global,1/a.l2.screen.viewScale);this.emit(ii.events.onUp,this._point.copyFrom(e))}}(0,y.Z)(ii,"events",{onDown:"InputManagerOnDown",onMove:"InputManagerOnMove",onUp:"InputManagerOnUp"});class si extends ti{constructor(t){super(t),(0,y.Z)(this,"_inputManager",void 0),this._inputManager=(new ii).on(ii.events.onDown,this._onDown,this).on(ii.events.onMove,this._onMove,this).on(ii.events.onUp,this._onUp,this),this._inputManager.setEnabled(!0),b.q.event.on(f.TQ.ballVSbrickContact,this._onBallVsBrickContact,this),b.q.event.on(f.TQ.ballVSlineContact,this._onBallVsLineContact,this)}onDestroy(){this._inputManager.setEnabled(!1),this._inputManager=null,super.onDestroy()}onRoomStateUpdate(t){switch(t){case ue.os.over:this._inputManager.setEnabled(!1);break;case ue.os.idle:this._inputManager.setEnabled(!0)}}onLineStateUpdate(t,e){switch(t){case ze.V.idle:this._inputManager.setEnabled(!0);break;case ze.V.hit:this._inputManager.endMove();break;case ze.V.drawEnd:this._inputManager.setEnabled(!1)}}onLineLimit(t){this._inputManager.endMove(t)}_onBallVsBrickContact(t,e,i){e===this.view.fence.uuid&&this.view.onBallVsBrickContact()}_onBallVsLineContact(t,e){e===this.view.line.uuid&&this.view.onBallVsLineContact()}_onDown(t){!super.startDraw(t)&&this._inputManager.reset()}_onMove(t){super.updateDraw(t)}_onUp(t){super.endDraw(t)}}class ai extends H.AeJ{constructor(t,e){super(),this._model=e}resize(t){this.copyFrom(t)}destroy(){}}var ni=i(7679);class oi{constructor(t,e){(0,y.Z)(this,"view",void 0),(0,y.Z)(this,"body",void 0),this.model=t,this.position=e}get uuid(){return this.model.uuid}destroy(){this._destroyBody(),this.view.destroy(),O.off(f.bk.postSolve,this._disableBody,this)}build(t){return this.buildView(t),this.buildBody(t),this}die(){O.once(f.bk.postSolve,this._disableBody,this)}_disableBody(){this.body.SetEnabled(!1)}_destroyBody(){this._disableBody(),a.l2.physics2D.world.DestroyBody(this.body)}}class ri extends oi{constructor(){super(...arguments),(0,y.Z)(this,"_theme",void 0),(0,y.Z)(this,"_castle",void 0),(0,y.Z)(this,"_flag",void 0),(0,y.Z)(this,"_anim",void 0)}updateTheme(t){const{bg:e,anim:i}=t;this._theme=t,this._castle.tint=e,this._anim.state.setAnimation(0,i,!1)}setFlag(t){this._flag.text=t,qt(this._flag,60,70)}updateLives(t){}die(){super.die(),this._startDisappearing()}buildBody(t){const{uuid:e,fenceId:i}=this.model;this.body=J(((t,e,i,s,n)=>{const{box2d:o,contactManager:r}=a.l2.physics2D,{filterMap:h}=r;return{userData:{data:{fenceId:e}},filters:h.brick,bodyDef:{type:o.b2_staticBody},fixturesDefs:[{shape:W(p(s.width),p(s.height)),userData:{id:t,group:i}},{shape:W(p(330),p(220),G(0,-.1*n)),userData:{group:i},isSensor:!0}]}})(e,i,L.brick,s.Jy[s.Gv.castle],t))}buildView(t){this.view=new H.W20,this.view.position.copyFrom(this.position),this._buildCastle(),this._buildFlag(),this._buildAnim(),this.view.addChild(this._castle,this._anim,this._flag)}_buildCastle(){this._castle=zt({texture:Bt.P.castle})}_buildFlag(){this._flag=Ot({text:"🏁",position:{x:0,y:10},style:{fontFamily:jt.HelveticaRegular,fontSize:60}})}_buildAnim(){this._anim=(t=>{const{skeleton:e,position:i={x:0,y:0},scale:s={x:1,y:1},speed:a=1}=t,n=new At(e);return n.position.copyFrom(i),n.scale.copyFrom(s),n.state.timeScale=a,n})({skeleton:bt.U.castle.skeleton}),this._anim.state.timeScale=0,this._anim.y=this._castle.height/2,this._anim.visible=!1}_startDisappearing(){this._startFlagDisappearing(),this._startCastleDisappearing()}_startFlagDisappearing(){Ct.ZP.to(this._flag,{pixi:{alpha:0,scale:1.6},duration:.3,universal:!0})}_startCastleDisappearing(){this._castle.visible=!1,this._anim.state.timeScale=1,this._anim.visible=!0}}class hi extends $e{constructor(){super({text:{fontName:Nt.HelveticaBold,align:"center",fontSize:44},tween:{pixi:{alpha:0},delay:1,duration:.5,data:{active:!1},ease:Tt.Yv.easeOut}})}}class li extends At{constructor(){super(bt.U.shield.skeleton),(0,y.Z)(this,"_body",void 0),(0,y.Z)(this,"_onAnimationStart",(t=>{const{name:e}=t.animation;if(e===bt.U.shield.animations.show)this.visible=!0,this._body.SetEnabled(!0)})),(0,y.Z)(this,"_onAnimationComplete",(t=>{const{name:e}=t.animation;if(e===bt.U.shield.animations.hide)this.visible=!1,this._body.SetEnabled(!1)})),this._initializeAnimation()}destroy(){this._body.SetEnabled(!1),a.l2.physics2D.world.DestroyBody(this._body),super.destroy()}resize(){const t=n.E9.scalar(this.getGlobalPosition(),1/a.l2.screen.viewScale);this._body.SetTransform(G(p(t.x),p(t.y)),0)}build(t){return this.rotation=t===s.cI.top?Math.PI:0,this._body=J((t=>{const{box2d:e,contactManager:i}=a.l2.physics2D,{filterMap:s}=i;return{userData:{},filters:s.shield,bodyDef:{type:e.b2_staticBody},fixturesDefs:[{shape:W(p(570),p(340),{x:p(0),y:p(-170*t)}),userData:{group:L.shield}}]}})(t)),this._body.SetEnabled(!1),this.visible=!1,this}show(){const{show:t,idle:e}=bt.U.shield.animations;this.state.setAnimation(0,t,!1),this.state.addAnimation(0,e,!0,0)}hide(){const{hide:t}=bt.U.shield.animations;this.state.setAnimation(0,t,!1)}_initializeAnimation(){const{show:t,idle:e,hide:i}=bt.U.shield.animations;this.state.addListener({start:this._onAnimationStart,complete:this._onAnimationComplete}),this.state.data.setMix(t,e,.2),this.state.data.setMix(e,i,.2)}}class di extends oi{constructor(){super(...arguments),(0,y.Z)(this,"_theme",void 0),(0,y.Z)(this,"_brick",void 0),(0,y.Z)(this,"_corner",void 0),(0,y.Z)(this,"_label",void 0),(0,y.Z)(this,"_emitter",void 0)}updateTheme(t){const{bg:e,text:i}=t;this._theme=t,this._brick.tint=e,this._corner.tint=e,this._label.tint=i}updateLives(t,e){if(0===t)return;this._label.text="".concat(t);const i=t/e;this._brick.alpha=i,this._corner.alpha=i,this._label.alpha=i}die(){super.die(),this._startDisappearing()}buildBody(t){const{uuid:e,fenceId:i}=this.model;this.body=J(((t,e,i,s)=>{const{box2d:n,contactManager:o}=a.l2.physics2D,{filterMap:r}=o;return{userData:{data:{fenceId:e}},filters:r.brick,bodyDef:{type:n.b2_staticBody},fixturesDefs:[{shape:W(p(s.width),p(s.height)),userData:{id:t,group:i}}]}})(e,i,L.brick,s.Jy[s.Gv.soldier]))}buildView(t){const{width:e,height:i}=s.Jy[s.Gv.soldier];this.view=new H.W20,this.view.position.set(this.position.x*e,this.position.y*i),this._buildBrick(),this._buildCorner(),this._buildLabel(),this._buildEmitter(),this.view.addChild(this._brick,this._corner,this._label)}_buildBrick(){this._brick=zt({texture:Bt.P["brick-bg"]})}_buildCorner(){this._corner=zt({texture:Bt.P["brick-corner"]}),this._updateCornerTransform()}_buildLabel(){this._label=Ot({text:" ",style:{fontName:Nt.HelveticaRegular,fontSize:50}})}_buildEmitter(){this._emitter=It({parent:this.view,config:ye["brick-hit"]}),this._emitter.fillPool(20)}_updateCornerTransform(){const{width:t,height:e}=s.Jy[s.Gv.soldier],{x:i,y:a}=this.position,n=Math.sign(i),o=Math.sign(a),r=Math.abs(i),h=Math.abs(a);switch(!0){case r===h:this._corner.visible=!1;break;case h<2:this._corner.rotation=.5*Math.PI*-n,this._corner.x=(.5*t+6)*-n;break;case 2===h:this._corner.rotation=-1===o?Math.PI*-o:0,this._corner.y=(.5*e+6)*-o}}_startDisappearing(){this._corner.visible=!1;const t=zt({texture:Bt.P["brick-outline-01"]}),e=zt({texture:Bt.P["brick-outline-02"]}),i=zt({texture:Bt.P["brick-outline-03"]}),s=this._brick.alpha;t.alpha=e.alpha=i.alpha=0,t.tint=e.tint=i.tint=this._theme.text,this.view.addChild(t,e,i),Ct.ZP.timeline({onComplete:()=>{this._brick.visible=!1,this._corner.visible=!1,this._label.visible=!1,t.destroy(),e.destroy(),i.destroy(),this._updateEmitter(),this._emitter.playOnceAndDestroy()}}).add(Ct.ZP.to(t,{pixi:{alpha:s},ease:Tt.Ll.easeOut,duration:.05})).add(Ct.ZP.to(e,{pixi:{alpha:s},ease:Tt.Ll.easeOut,duration:.05})).add(Ct.ZP.to(i,{pixi:{alpha:s},ease:Tt.Ll.easeOut,duration:.16}))}_updateEmitter(){{const t=this._emitter.getBehavior("color"),e=(0,n.Zu)(this._theme.bg),i=t.list.first,s=t.list.first.next;i.value=s.value=e}{const t=this._emitter.getBehavior("alpha"),e=2*this._brick.alpha,i=t.list.first,s=t.list.first.next;i.value=s.value=e}}}class ci extends H.W20{constructor(t,e,i){super(),(0,y.Z)(this,"_notification",void 0),(0,y.Z)(this,"_bricks",void 0),(0,y.Z)(this,"_soldiers",void 0),(0,y.Z)(this,"_castle",void 0),(0,y.Z)(this,"_shield",void 0),this._parent=t,this._model=e,this._side=i,b.q.event.on(w.L6.livesUpdate,this._onBrickLivesUpdate,this),b.q.event.on(w.XZ.livesUpdate,this._onBrickLivesUpdate,this),b.q.event.on(w.L6.stateUpdate,this._onBrickStateUpdate,this),b.q.event.on(w.XZ.stateUpdate,this._onBrickStateUpdate,this),this._buildBricks(),this._buildShield(),this._buildNotification(),this._parent.addChild(this),this._show()}get uuid(){return this._model.uuid}get castle(){return this._castle}destroy(){b.q.event.removeListenersOf(this),this._bricks.forEach((t=>t.destroy())),this._shield.destroy(),super.destroy()}resize(t){const{x:e,y:i,width:s,height:o}=t;this.position.set(e+.5*s,i+.5*o+this._side*o*.5),this._bricks.forEach((t=>{const e=n.E9.scalar(t.view.getGlobalPosition(),1/a.l2.screen.viewScale);t.body.SetTransform(G(p(e.x),p(e.y)),0)})),this._shield.resize()}updateTheme(t){let{soldier:e,castle:i}=t;this._soldiers.forEach((t=>t.updateTheme(e))),this._castle.updateTheme(i),this._notification.updateTheme(i.bg)}setShield(t){t?this._showShield():this._hideShield()}getBrickById(t){return this._bricks.find((e=>e.uuid===t))}notifyProtect(){if(m(.2)){const t=[vt["protect-fail-01"],vt["protect-fail-02"]];this._notification.notify((0,Xe.Z)(t))}}_onBrickLivesUpdate(t,e,i){var s;null===(s=this.getBrickById(i))||void 0===s||s.updateLives(t,this._model.maxLife)}_onBrickStateUpdate(t,e,i){var s;t!==ni.E.alive&&(null===(s=this.getBrickById(i))||void 0===s||s.die())}_show(){const t=this._soldiers.map((t=>t.view));this._side===s.cI.top&&t.reverse();const e=this._castle.view,i=t.map((t=>t.alpha)),n=e.alpha,o=this._bricks.map((t=>t.view));o.forEach((t=>t.alpha=0)),a.l2.ticker.post((()=>{o.forEach((t=>t.scale.set(0)));const s=Ct.ZP.timeline({universal:!0});t.forEach(((t,e)=>{s.add(Ct.ZP.to(t,Dt(i[e],.3,2)),.05*e)})),s.add(Ct.ZP.to(e,Dt(n,.6,3)),.6)}))}_showShield(){this._shield.show()}_hideShield(){this._shield.hide()}_buildBricks(){this._buildCastle(),this._buildSoldiers(),this._bricks=[this._castle,...this._soldiers]}_buildSoldiers(){const t=this._model.soldiers;this._soldiers=t.map(((e,i)=>{const[a,n]=s.kn[i],o=new di(t[i],{x:a,y:n*this._side}).build(this._side);return o.view.y-=(s.Jy[s.Gv.soldier].height/2-1)*this._side,this.addChild(o.view),o})),this._soldiers.forEach(((e,i)=>e.updateLives(t[i].lives,this._model.maxLife)))}_buildCastle(){this._castle=new ri(this._model.castle,{x:0,y:-100*this._side}).build(this._side),this._castle.setFlag(this._model.flag),this.addChild(this._castle.view)}_buildShield(){this._shield=(new li).build(this._side),this.addChild(this._shield)}_buildNotification(){this._notification=new hi,this._notification.position.set(0,-this._side*(this.height+60)),this.addChild(this._notification)}}class _i{constructor(t,e){(0,y.Z)(this,"_fence",void 0),(0,y.Z)(this,"_area",void 0),(0,y.Z)(this,"_line",void 0),this.model=e;const{fence:i,line:s,area:a}=this.model;this._buildFence(t,i),this._buildArea(t,a),this._buildLine(t,s)}get uuid(){return this.model.uuid}get fence(){return this._fence}get area(){return this._area}get line(){return this._line}get side(){return this.model.side}onDestroy(){b.q.event.removeListenersOf(this),this._fence.destroy(),this._line.destroy()}onResize(t){this._fence.resize(t),this._area.resize(t)}applyTheme(t){const{fence:e,line:i}=t;this._fence.updateTheme(e),this._line.updateTheme(i)}_buildFence(t,e){this._fence=new ci(t,e,this.side)}_buildArea(t,e){this._area=new ai(t,e)}_buildLine(t,e){this._line=new Qe(t,e)}}class ui extends _i{constructor(t,e){super(t,e)}}class pi extends _i{constructor(t,e){super(t,e)}onBallVsBrickContact(){this.fence.notifyProtect()}onBallVsLineContact(){this.line.notifyProtect()}}class gi{constructor(t,e){(0,y.Z)(this,"_fever",void 0),(0,y.Z)(this,"_player",void 0),(0,y.Z)(this,"_opponent",void 0),(0,y.Z)(this,"_playerManager",void 0),(0,y.Z)(this,"_opponentManager",void 0),this._parent=t,this._model=e;const{player:i,opponent:s,fever:a}=this._model;this._buildPlayer(i),this._buildOpponent(s),this._buildFever(a),this._initPlayers(),this._applyTheme(),b.q.event.on(w.PV.shieldUpdate,this._onFenceShieldUpdate,this)}get player(){return this._player}get opponent(){return this._opponent}onDestroy(){b.q.event.removeListenersOf(this),this._playerManager.onDestroy(),this._opponentManager.onDestroy(),this._player.onDestroy(),this._opponent.onDestroy()}onResize(t){const{x:e,y:i,width:s,height:a}=t,o=new n.UL(e,i+.5*a,s,.5*a),r=new n.UL(e,i,s,.5*a);this.player.onResize(o),this.opponent.onResize(r),this._fever.onResize(t)}onUpdate(t,e){}onRoomStateUpdate(t){this._playerManager.onRoomStateUpdate(t),this._opponentManager.onRoomStateUpdate(t)}onRoomStatusUpdate(t){this._fever.disable()}_onFenceShieldUpdate(t,e,i){this._getPlayerByFenceId(i).fence.setShield(t)}_buildPlayer(t){this._player=new pi(this._parent,t),this._playerManager=new si(this._player)}_buildOpponent(t){this._opponent=new ui(this._parent,t),this._opponentManager=new ei(this._opponent,this._getBotAccuracy(x.h.user.rank.rank))}_buildFever(t){this._fever=new Fe(t),this._parent.addChild(this._fever)}_applyTheme(){const t=Mt.X.getRoomPlayers(this.player.side),e=Mt.X.getRoomPlayers(this.opponent.side);this._player.applyTheme(t),this._opponent.applyTheme(e),this._fever.applyTheme(t.line.color,e.line.color)}_initPlayers(){this._playerManager.setTarget(this._opponent.fence),this._opponentManager.setTarget(this._player.fence)}_getBotAccuracy(t){return{logic:.5,miss:.1}}_getPlayerByFenceId(t){return this._player.fence.uuid===t?this._player:this._opponent}}class mi extends Xt{constructor(){super({delay:.2,repeatDelay:1,length:300,angle:0*Math.PI,distance:600,label:" "}),this.updateTheme(Mt.X.getTutorial().protect)}onResize(t){const{x:e,y:i}=g(t);this.position.set(e-150,i+300)}}class yi extends H.W20{constructor(){super(),(0,y.Z)(this,"_playerSet",void 0),(0,y.Z)(this,"_ballSet",void 0),(0,y.Z)(this,"_bonusSet",void 0),(0,y.Z)(this,"_counter",void 0),(0,y.Z)(this,"_tutorial",void 0),(0,y.Z)(this,"_area",void 0),b.q.event.on(w.dY.tutorialUpdate,this._onTutorialUpdate,this)}destroy(){b.q.event.removeListenersOf(this),this._playerSet.onDestroy(),this._ballSet.onDestroy(),this._bonusSet.onDestroy(),this._counter.onDestroy(),this._playerSet=null,this._ballSet=null,this._bonusSet=null,this._counter=null,super.destroy()}onResize(t){this._area=t}onUpdate(t,e){var i,s,a;null===(i=this._playerSet)||void 0===i||i.onUpdate(t,e),null===(s=this._ballSet)||void 0===s||s.onUpdate(t,e),null===(a=this._bonusSet)||void 0===a||a.onUpdate(t,e)}onStateUpdate(t){var e,i,s;if(t===ue.os.idle)this._build(x.h.game.room);null===(e=this._playerSet)||void 0===e||e.onRoomStateUpdate(t),null===(i=this._ballSet)||void 0===i||i.onRoomStateUpdate(t),null===(s=this._bonusSet)||void 0===s||s.onRoomStateUpdate(t)}onStatusUpdate(t){var e,i,s;null===(e=this._playerSet)||void 0===e||e.onRoomStatusUpdate(t),null===(i=this._ballSet)||void 0===i||i.onRoomStatusUpdate(t),null===(s=this._bonusSet)||void 0===s||s.onRoomStatusUpdate(t)}_build(t){const{playerSet:e,ballSet:i,bonusSet:s,counter:a}=t;this._buildPlayerSet(e),this._buildBallSet(i),this._buildBonusSet(s),this._buildCounter(a),this._resize()}_buildPlayerSet(t){this._playerSet=new gi(this,t)}_buildBallSet(t){this._ballSet=new Ze(this,t)}_buildBonusSet(t){this._bonusSet=new Ue(this,t)}_buildCounter(t){this._counter=new Le(t),this.addChild(this._counter)}_onTutorialUpdate(t){null!=t?this._buildTutorial():this._destroyTutorial()}_buildTutorial(){this._tutorial=new mi,this._tutorial.onResize(this._area),this.addChild(this._tutorial)}_destroyTutorial(){this._tutorial.destroy(),this._tutorial=null}_resize(){const{_area:t}=this;this._playerSet.onResize(t),this._ballSet.onResize(t),this._bonusSet.onResize(t),this._counter.onResize(t)}}class vi extends H.jyi{constructor(){super(H.xEZ.from(Bt.P["white-square"])),(0,y.Z)(this,"_body",void 0),this.tint=Mt.X.getRoomDivider(),this._body=J((t=>{const{box2d:e,contactManager:i}=a.l2.physics2D,{filterMap:s}=i;return{userData:{},filters:s.divider,bodyDef:{type:e.b2_staticBody,allowSleep:!0},fixturesDefs:[{shape:W(20,.1,{x:10,y:.05}),userData:{id:t,group:L.divider},isSensor:!0}]}})("divider"))}resize(t,e){this.scale.set(1,1),this.scale.set(t/this.width,2),this.position.set(0,e),this._body.SetTransform(G(0,p(e)),0)}}class bi extends H.W20{constructor(){super(),(0,y.Z)(this,"_divider",void 0),this._buildDivider(),this._buildWalls()}onResize(t){this._resizeDivider(t),this._resizeWalls(t)}_buildDivider(){this._divider=new vi,this.addChild(this._divider)}_buildWalls(){}_resizeDivider(t){this._divider.resize(t.width,t.height/2)}_resizeWalls(t){const{x:e,y:i,width:s,height:a}=t,n=this._makeWall("top_wall",{x:e,y:i,width:p(s),height:p(100)}),o=this._makeWall("top_wall",{x:e,y:i,width:p(s),height:p(100)}),r=this._makeWall("top_wall",{x:e,y:i,width:p(100),height:p(a)}),h=this._makeWall("top_wall",{x:e,y:i,width:p(100),height:p(a)});n.SetTransform(G(0,-p(100)),0),o.SetTransform(G(0,p(a)),0),r.SetTransform(G(p(s),0),0),h.SetTransform(G(-p(100),0),0)}_makeWall(t,e){return J(((t,e)=>{const{box2d:i,contactManager:s}=a.l2.physics2D,{filterMap:n}=s,{x:o,y:r,width:h,height:l}=e;return{userData:{},filters:n.wall,bodyDef:{type:i.b2_staticBody,allowSleep:!0,position:G(o,r)},fixturesDefs:[{restitution:1,restitutionThreshold:0,shape:W(h,l,{x:h/2,y:l/2}),userData:{id:t,group:L.wall}}]}})(t,e))}}class wi extends H.W20{constructor(){super(),(0,y.Z)(this,"_contactManager",void 0),(0,y.Z)(this,"_camera",void 0),(0,y.Z)(this,"_roomStatic",void 0),(0,y.Z)(this,"_roomDynamic",void 0),this._createCamera(),this._createRoomStatic(),this._createCollisionManager(),b.q.event.on(w.N.roomUpdate,this._onRoomUpdate,this),b.q.event.on(w.dY.stateUpdate,this._onStateUpdate,this),b.q.event.on(w.dY.statusUpdate,this._onStatusUpdate,this)}get area(){return _t.getGridConfig(dt.room).bounds}onResize(){this._camera.onResize(this.area)}onUpdate(t,e){var i;null===(i=this._roomDynamic)||void 0===i||i.onUpdate(t,e)}onShowStart(){this.cacheAsBitmap=!1}onShowComplete(){}onHideStart(){this.cacheAsBitmap=!0}onHideComplete(){this._camera.reset()}_createCamera(){this._camera=new pe(this)}_createCollisionManager(){this._contactManager=new ge}_onRoomUpdate(t){null!=t?this._createRoomDynamic(t):this._destroyRoomDynamic()}_createRoomStatic(){this._roomStatic=new bi,this._roomStatic.onResize(this.area),this.addChild(this._roomStatic)}_createRoomDynamic(t){this._roomDynamic=new yi,this._roomDynamic.onResize(this.area),this.addChild(this._roomDynamic)}_destroyRoomDynamic(){this._roomDynamic.destroy(),this._roomDynamic=null}_onStatusUpdate(t){switch(this._roomDynamic.onStatusUpdate(t),t){case ue.J7.win:this._camera.panZoom(),this._emitOverSequenceComplete(2.6);break;case ue.J7.defeat:this._camera.shake(),this._emitOverSequenceComplete(2)}}_onStateUpdate(t){this._roomDynamic.onStateUpdate(t)}_emitOverSequenceComplete(t){a.l2.ticker.delay({delay:t*n.wI,callback:()=>{b.q.event.emit(f.TQ.overSequenceComplete)}})}}class fi extends H.W20{constructor(t){super(),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_star",void 0),(0,y.Z)(this,"_progress",void 0),(0,y.Z)(this,"_progressMask",void 0),this._model=t,b.q.event.on(w.Vr.rankUpdate,this._onRankUpdate,this).on(w.Vr.progressUpdate,this._onProgressUpdate,this)}postBuild(){this._buildBg(),this._buildProgress(),this._buildText(),this._buildStar(),this._updateRank(this._model.rank),this._updateProgress(this._model.progress)}_buildBg(){this._bg=zt({texture:Bt.P["rank-bg"]}),this.addChild(this._bg)}_buildProgress(){this._progress=zt({texture:Bt.P["rank-fill-iron"]}),this._progress.position.set(-0,-2.5),this.addChild(this._progress);const{width:t,height:e}=this._progress;this._progressMask=new H.TCu,this._progressMask.position.set(.5*-t,.5*-e),this.addChild(this._progressMask),this._progress.mask=this._progressMask}_buildText(){}_buildStar(){this._star=zt({texture:Bt.P["rank-star-iron"]}),this._star.position.set(-150,0),this.addChild(this._star)}_onRankUpdate(t){this._updateRank(t)}_onProgressUpdate(t){this._updateProgress(t)}_updateRank(t){this._star.texture=H.xEZ.from(Bt.P["rank-star-".concat(t)]),this._progress.texture=H.xEZ.from(Bt.P["rank-fill-".concat(t)])}_updateProgress(t){const{width:e,height:i}=this._progress;this._progressMask.clear(),this._progressMask.beginFill(),this._progressMask.drawRect(0,0,e*t,i),this._progressMask.endFill()}}class xi extends Y.D3{constructor(){super(),(0,y.Z)(this,"_theme",void 0),(0,y.Z)(this,"_sound",void 0),(0,y.Z)(this,"_haptic",void 0),(0,y.Z)(this,"_sectors",void 0),(0,y.Z)(this,"_userRank",void 0),b.q.event.on(w.ce.themeUpdate,this._onThemeUpdate,this).on(w.ce.soundUpdate,this._onSoundUpdate,this).on(w.ce.hapticUpdate,this._onHapticUpdate,this),this._build(),this._applyTheme()}getGridConfig(){return _t.getGridConfig(dt.ui)}onResize(){super.rebuild(this.getGridConfig())}onUpdate(t,e){}onShowStart(){this.cacheAsBitmap=!1}onShowComplete(){this._theme.input(!0),this._sound.input(!0),this._haptic.input(!0)}onHideStart(){this.cacheAsBitmap=!0,this._theme.input(!1),this._sound.input(!1),this._haptic.input(!1)}onHideComplete(){}_build(){this.setChild("theme",this._theme=this._buildThemeButton()),this.setChild("sound",this._sound=this._buildSoundButton()),this.setChild("haptic",this._haptic=this._buildHapticButton()),this.setChild("user_rank",this._userRank=this._buildUserRankView()),this._buildSectors()}_applyTheme(){const{theme:t,sound:e,haptic:i}=x.h.user.settings;this._onThemeUpdate(t),this._onSoundUpdate(e),this._onHapticUpdate(i)}_onThemeUpdate(t){this._theme.setState(t===s.Q2.light?s.rs.on:s.rs.off),this._updateTheme(Mt.X.getUi())}_onSoundUpdate(t){this._sound.setState(t?s.rs.on:s.rs.off)}_onHapticUpdate(t){this._haptic.setState(t?s.rs.on:s.rs.off)}_updateTheme(t){let{color:e}=t;this._theme.bg.tint=e,this._sound.bg.tint=e,this._haptic.bg.tint=e,this._sectors.forEach((t=>t.updateTheme(e)))}_buildSectors(){const t=new ki,e=new Ci,i=new Ci;this.setChild("sector_horizontal",t),this.setChild("sector_vertical_left",e),this.setChild("sector_vertical_right",i),this._sectors=[t,e,i]}_buildThemeButton(){const t=new ee({input:{enable:!0},states:{on:{texture:Bt.P["icon-theme-light"]},off:{texture:Bt.P["icon-theme-dark"]}}});return t.on("interaction",this._onThemeClick,this),t}_buildSoundButton(){const t=new ee({input:{enable:!0},states:{on:{texture:Bt.P["icon-sound-on"]},off:{texture:Bt.P["icon-sound-off"]}}});return t.on("interaction",this._onSoundClick,this),t}_buildHapticButton(){const t=new ee({input:{enable:!0},states:{on:{texture:Bt.P["icon-haptic-on"]},off:{texture:Bt.P["icon-haptic-off"]}}});return t.on("interaction",this._onHapticClick,this),t}_buildUserRankView(){return new fi(x.h.user.rank)}_onThemeClick(){b.q.event.emit(f.mX.themeClick)}_onSoundClick(){b.q.event.emit(f.mX.soundClick)}_onHapticClick(){b.q.event.emit(f.mX.hapticClick)}}(0,y.Z)(xi,"themeClick","UiSceneThemeClick"),(0,y.Z)(xi,"soundClick","UiSceneSoundClick"),(0,y.Z)(xi,"hapticClick","UiSceneHapticClick");class Si extends H.jyi{constructor(t){super(t)}updateTheme(t){this.tint=t}}class ki extends Si{constructor(){super(H.xEZ.from(Bt.P["ui-stroke-horizontal"]))}resize(t,e){this.width=t}}class Ci extends Si{constructor(){super(H.xEZ.from(Bt.P["ui-stroke-vertical"]))}resize(t,e){this.height=e}}i(7950);class Ti extends H.W20{constructor(){super(),(0,y.Z)(this,"_fence",void 0),(0,y.Z)(this,"_name",void 0),(0,y.Z)(this,"_flag",void 0),(0,y.Z)(this,"_searchingTask",void 0),this._buildFence(),this._buildName(),this._buildFlag()}setName(t){this._name.text=t.toUpperCase(),qt(this._name,.9*this._fence.width,this._name.height)}setFlag(t){var e;this._flag.text=null!==(e=s.id.get(t))&&void 0!==e?e:s.id.get(" "),qt(this._flag,130,160)}updateTheme(t){let{fenceColor:e,nameColor:i}=t;this._fence.tint=e,this._name.tint=i}startSearching(){const t=Array.from(s.id.keys()).slice(1);this._searchingTask=a.l2.ticker.delay({loop:!0,delay:160,callback:()=>{var e;const i=null!==(e=(0,Xe.Z)(t))&&void 0!==e?e:" ";this.setFlag(s.id.has(i)&&null!=i?i:" ")}})}stopSearching(){null!=this._searchingTask&&a.l2.ticker.cancel(this._searchingTask)}reset(){this.setName(" "),this.setFlag(" ")}_buildFence(){this._fence=zt({texture:Bt.P["winner-castle"]}),this.addChild(this._fence)}_buildName(){this._name=Ot({text:" ",position:{x:0,y:210},style:{letterSpacing:4,fontName:Nt.HelveticaLight,fontSize:50}}),this.addChild(this._name)}_buildFlag(){this._flag=Ot({text:"🏁",position:{x:0,y:70},style:{fontFamily:jt.HelveticaRegular,fontSize:130}}),this.setFlag("🏁"),this.addChild(this._flag)}}class Pi extends H.Xz2{constructor(){const{text:t,style:e}=Wt();super(t,e),(0,y.Z)(this,"_searchingTask",void 0)}updateTheme(t){let{color:e}=t;this.tint=e}startSearching(){const t=this.text.length;this._searchingTask=a.l2.ticker.delay({loop:!0,delay:500,callback:()=>{this.text=this.text.length>t+2?this.text.substring(0,t):this.text.concat(".")}})}stopSearching(){a.l2.ticker.cancel(this._searchingTask),this.text=Wt().text}}class Zi extends H.jyi{constructor(){const{texture:t}={texture:Bt.P["versus-vs"]};super(H.xEZ.from(t))}updateTheme(t){this.tint=t.color}}class Di extends Y.D3{constructor(){super(),(0,y.Z)(this,"_player",void 0),(0,y.Z)(this,"_opponent",void 0),(0,y.Z)(this,"_search",void 0),(0,y.Z)(this,"_vs",void 0),b.q.event.on(w.ce.themeUpdate,this._onThemeUpdate,this).on(w.u2.playerUpdate,this._onPlayerUpdate,this).on(w.u2.opponentUpdate,this._onOpponentUpdate,this),this._build(),this._applyTheme()}getGridConfig(){return _t.getGridConfig(dt.versus)}onResize(){super.rebuild(this.getGridConfig())}onUpdate(t,e){}onShowStart(){this.cacheAsBitmap=!1}onShowComplete(){}onHideStart(){this.cacheAsBitmap=!0}onHideComplete(){this._player.reset(),this._opponent.reset()}_build(){this._buildPlayer(),this._buildOpponent(),this._buildVersusText(),this._buildSearchingText()}_applyTheme(){this._onThemeUpdate()}_startSearching(){this._search.startSearching(),this._opponent.startSearching()}_stopSearching(){this._search.stopSearching(),this._opponent.stopSearching()}_onThemeUpdate(){const{player:t,opponent:e,vs:i,search:s}=Mt.X.getVersus();this._player.updateTheme(t),this._opponent.updateTheme(e),this._vs.updateTheme(i),this._search.updateTheme(s)}_onPlayerUpdate(t){this._startSearching();const{name:e,countryCode:i}=t;this._player.setName(e),this._player.setFlag(i)}_onOpponentUpdate(t){this._stopSearching();const{name:e,countryCode:i}=t;this._opponent.setName(e),this._opponent.setFlag(i)}_buildPlayer(){this._player=new Ti,this.setChild("player",this._player)}_buildOpponent(){this._opponent=new Ti,this.setChild("opponent",this._opponent)}_buildVersusText(){this._vs=new Zi,this.setChild("vs",this._vs)}_buildSearchingText(){this._search=new Pi,this.setChild("search",this._search)}}class Mi{constructor(t){(0,y.Z)(this,"_sceneMap",new Map),(0,y.Z)(this,"_bg",void 0),(0,y.Z)(this,"_intro",void 0),(0,y.Z)(this,"_ui",void 0),(0,y.Z)(this,"_versus",void 0),(0,y.Z)(this,"_room",void 0),(0,y.Z)(this,"_result",void 0),t.addChild(this._bg=new Vt),t.addChild(this._intro=new Yt),t.addChild(this._ui=new xi),t.addChild(this._versus=new Di),t.addChild(this._room=new wi),t.addChild(this._result=new _e),this._initSceneMap(),this._hideAllScenes(),b.q.event.on(w.N.stateUpdate,this._onStateUpdate,this)}resize(){this._sceneMap.forEach((t=>t.forEach((t=>t.onResize()))))}update(t,e){this._sceneMap.forEach((i=>i.forEach((i=>i.onUpdate(t,e)))))}_initSceneMap(){this._sceneMap.set(Pt.D.intro,[this._bg,this._intro,this._ui]),this._sceneMap.set(Pt.D.versus,[this._versus]),this._sceneMap.set(Pt.D.play,[this._room]),this._sceneMap.set(Pt.D.result,[this._result])}_hideAllScenes(){this._sceneMap.forEach((t=>t.forEach((t=>t.visible=!1))))}_onStateUpdate(t,e){const i=this._sceneMap.get(e),s=this._sceneMap.get(t),a=x.h.user.ftue;null!=i&&this._startOldScenesHide(i,a),null!=s&&this._startNewScenesShow(s,a||null==i)}_startOldScenesHide(t,e){Ct.ZP.to(t,Zt(this,Tt.lD.easeOut)).eventCallback("onStart",(()=>{t.forEach((t=>{t.onHideStart()}))})).eventCallback("onComplete",(()=>{t.forEach((t=>{t.alpha=1,t.visible=!1,t.onHideComplete()}))})).totalProgress(e?1:0)}_startNewScenesShow(t,e){Ct.ZP.from(t,Zt(this,Tt.lD.easeIn)).eventCallback("onStart",(()=>{t.forEach((t=>{t.alpha=0,t.visible=!0,t.onShowStart()}))})).eventCallback("onComplete",(()=>{t.forEach((t=>{t.onShowComplete()}))})).totalProgress(e?1:0)}}class Bi extends H.W20{constructor(){super(),(0,y.Z)(this,"_sceneManager",void 0),(0,y.Z)(this,"resize",(()=>{var t;null===(t=this._sceneManager)||void 0===t||t.resize()})),b.q.event.on(w.xw.gameUpdate,this._onGameUpdate,this)}update(t,e){var i;null===(i=this._sceneManager)||void 0===i||i.update(t,e)}_onGameUpdate(){this._sceneManager=new Mi(this),this._sceneManager.resize()}_logDisplayObjectsCount(){}_getChildrenCount(t,e){for(let i=0;i<t.children.length;i++){e+=1;const s=t.children[i];s.children.length>0&&(e+=this._getChildrenCount(s,0))}return e}}class Ui{constructor(t){(0,y.Z)(this,"loader",void 0),(0,y.Z)(this,"renderer",void 0),(0,y.Z)(this,"stage",void 0),(0,y.Z)(this,"ticker",void 0),this._app=t}async onInstall(){this.loader=new St,this.renderer=new H.Thl(function(){const t=window.globals.app.getPlugin(s.J0.three);return{view:document.getElementById("game_canvas"),context:null==t?void 0:t.renderer.getContext(),resolution:l(),backgroundAlpha:0,backgroundColor:0,clearBeforeRender:null==t,antialias:!((0,o.Z)().apple.device&&15.4===parseFloat(null!==(e=_.os.version)&&void 0!==e?e:"0"))};var e}()),this.stage=new Bi,this.ticker=H.vB5.shared,this.ticker.autoStart=!1,_t.init()}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){this.stage.update(t,e),this.ticker.update(t),this.renderer.render(this.stage)}onPause(){}onResume(){}onResize(t,e,i){_t.onResize(t),this.renderer.resize(i.width*e,i.height*e),this.stage.scale.set(e),this.stage.resize()}}class Ri{constructor(t){(0,y.Z)(this,"_pointerType","mouse"),(0,y.Z)(this,"_gameDiv",void 0),(0,y.Z)(this,"_firstInteraction",(()=>{this._app.firstInteraction()})),(0,y.Z)(this,"_interaction",(()=>{this._app.interaction()})),this._app=t}get interactive(){return"none"!==this._gameDiv.style.pointerEvents}set interactive(t){this._gameDiv.style.pointerEvents=t?"auto":"none"}init(){this._gameDiv=d(),this._detectPointerType(),this._addInteractionEvents()}_detectPointerType(){this._pointerType="onpointerdown"in window?"pointer":"ontouchstart"in window?"touch":"mouse"}_addInteractionEvents(){const t=Ri._pointerEventMap[this._pointerType].down;this._gameDiv.addEventListener(t,this._firstInteraction,{once:!0}),this._gameDiv.addEventListener(t,this._interaction,{once:!1})}}(0,y.Z)(Ri,"_pointerEventMap",{pointer:{down:"pointerdown"},mouse:{down:"mousedown"},touch:{down:"touchstart"}});var Ei=i(1739),Li=i(9218);class Fi{constructor(t){(0,y.Z)(this,"windowOrientation",void 0),(0,y.Z)(this,"appOrientation",void 0),(0,y.Z)(this,"designBounds",void 0),(0,y.Z)(this,"viewBounds",void 0),(0,y.Z)(this,"viewScale",void 0),(0,y.Z)(this,"_gameDiv",void 0),(0,y.Z)(this,"_gameBounds",void 0),(0,y.Z)(this,"_outerRect",void 0),(0,y.Z)(this,"_innerRect",void 0),(0,y.Z)(this,"resize",(()=>{this._updateWindowOrientation(),this._resizeGameContainer(),this._updateAppOrientation(),this._calculateTransform(),window.scroll(0,0),this._app.resize(this.appOrientation,this.viewScale,this.viewBounds)})),(0,y.Z)(this,"_calculateDesignBounds",(()=>{const{width:t,height:e}=Li.screen[this.appOrientation];this.designBounds.set(0,0,t,e)})),this._app=t}init(){this.designBounds=new n.UL,this.viewBounds=new n.UL,this._gameDiv=d(),this._outerRect=new n.UL,this._innerRect=new n.UL,this.viewScale=1,window.addEventListener("orientationchange",this.resize),window.addEventListener("resize",this.resize)}_updateWindowOrientation(){var t,e;this.windowOrientation=(t=n.i5.landscape,e=n.i5.portrait,window.matchMedia("(orientation: portrait)").matches?e:window.matchMedia("(orientation: landscape)").matches?t:e)}_updateAppOrientation(){this.appOrientation=this._gameBounds.width>this._gameBounds.height?n.i5.landscape:n.i5.portrait}_resizeGameContainer(){this._updateOuterRect(),this._updateInnerRect();const{x:t,y:e,width:i,height:s}=(0,n.cO)(this._innerRect,this._outerRect,!0);this._gameDiv.style.width="".concat(i,"px"),this._gameDiv.style.height="".concat(s,"px"),this._gameDiv.style.left="".concat(t,"px"),this._gameDiv.style.top="".concat(e,"px"),this._gameBounds=this._gameDiv.getBoundingClientRect()}_updateOuterRect(){const{width:t,height:e}=h();this._outerRect.set(0,0,t,e)}_updateInnerRect(){const{width:t,height:e}=h(),{screen:i}=Li,s=i.portrait.enabled,a=i.landscape.enabled,o=t=>{const{min:e,max:s}=c()?i.ratio.mobile:i.ratio.desktop;return t/(0,Ei.Z)(t,e,s)};switch(this._innerRect.set(0,0,t,e),!0){case s&&a:{const i=o(Math.min(t/e,e/t));this.windowOrientation===n.i5.landscape?this._innerRect.width*=i:this._innerRect.height*=i}break;case s:{const i=o(t/e);this._innerRect.set(0,0,t,e*i)}break;case a:{const i=o(e/t);this._innerRect.set(0,0,t*i,e)}}}_calculateTransform(){this._calculateDesignBounds(),this._calculateViewScale(),this._calculateViewBounds()}_calculateViewScale(){const{width:t,height:e}=this.designBounds,{width:i,height:s}=this._gameBounds;this.viewScale=Math.min(i/t,s/e,1)}_calculateViewBounds(){const{width:t,height:e}=this._gameBounds;this.viewBounds.set(0,0,t/this.viewScale,e/this.viewScale)}}class Ai{constructor(t){(0,y.Z)(this,"_gameDiv",void 0),(0,y.Z)(this,"_lockOrientationDiv",void 0),(0,y.Z)(this,"_onVisibilityChange",(t=>{this.isVisible()?this._app.resume():this._app.pause()})),this._app=t,this._lockOrientationDiv=document.getElementById("lock_orientation_div"),this._gameDiv=d(),this._gameDiv.classList.add("invisible-game")}init(){this._addVisibleChangeCallback()}show(){this._gameDiv.classList.remove("invisible-game"),this._gameDiv.classList.add("fade-in-game")}onResize(t,e){c()&&t!==e?this._lockOrientation():this._unlockOrientation()}isVisible(){return!1===document[Ai._keys.hidden]}_unlockOrientation(){this._gameDiv.style.visibility="visible",this._lockOrientationDiv.style.visibility="hidden"}_lockOrientation(){this._gameDiv.style.visibility="hidden",this._lockOrientationDiv.style.visibility="visible"}_detectPrefix(t){return null!=t.mozHidden?"moz":null!=t.msHidden?"ms":null!=t.webkitHidden?"webkit":""}_addVisibleChangeCallback(){const t=this._detectPrefix(document);Ai._keys.event="".concat(t,"visibilitychange"),Ai._keys.hidden=(0,n.te)("".concat(t,"Hidden")),document.addEventListener(Ai._keys.event,this._onVisibilityChange,{once:!1})}}(0,y.Z)(Ai,"_keys",{hidden:"",event:""});class zi{constructor(t){(0,y.Z)(this,"_interactionManager",void 0),(0,y.Z)(this,"_visibilityManager",void 0),(0,y.Z)(this,"_resizeManager",void 0),this._app=t,this._interactionManager=new Ri(this._app),this._visibilityManager=new Ai(this._app),this._resizeManager=new Fi(this._app),b.q.event.on(f.qp.start,this._onAppStart,this)}get appOrientation(){return this._resizeManager.appOrientation}get windowOrientation(){return this._resizeManager.windowOrientation}get designBounds(){return this._resizeManager.designBounds}get viewBounds(){return this._resizeManager.viewBounds}get viewScale(){return this._resizeManager.viewScale}get isVisible(){return this._visibilityManager.isVisible()}get interactive(){return this._interactionManager.interactive}set interactive(t){this._interactionManager.interactive=t}async onInstall(){this._interactionManager.init(),this._visibilityManager.init(),this._resizeManager.init()}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){}onPause(){}onResume(){this._resizeManager.resize()}onResize(t,e,i){this._visibilityManager.onResize(this.appOrientation,this.windowOrientation)}_onAppStart(){this._resizeManager.resize(),this._visibilityManager.show()}}const Ii={button:"button","line-draw":"line-draw","line-hit":"line-hit","opponent-brick-hit":"opponent-brick-hit","opponent-castle-hit":"opponent-castle-hit","player-brick-hit":"player-brick-hit","player-castle-hit":"player-castle-hit",theme:"theme"};var Oi=i(9218);class qi{constructor(t){(0,y.Z)(this,"_sounds",{}),(0,y.Z)(this,"_pausedSounds",[]),(0,y.Z)(this,"_onSoundUpdate",(t=>{window.Howler.mute(!t)})),(0,y.Z)(this,"_onLoadComplete",(t=>{this._initSounds(t),"extra"===t&&this._playTheme()})),(0,y.Z)(this,"_pauseAll",(()=>{Object.values(this._sounds).forEach((t=>{t.playing()&&(t.pause(),this._pausedSounds.push(t))}))})),(0,y.Z)(this,"_resumeAll",(()=>{Object.values(this._sounds).forEach((t=>{const e=this._pausedSounds.indexOf(t);-1!==e&&(t.play(),this._pausedSounds.splice(e,1))}))})),(0,y.Z)(this,"_initSounds",(t=>{var e;const i=null===(e=Oi.load[t].generic)||void 0===e?void 0:e.sounds;if(0===i.length)return;const s=window.Howler._howls,a=s.length-i.length;i.forEach(((t,e)=>{const n=s[e+a];null!=n&&(this._sounds[i[e]]=n)}))})),this._app=t}async onInstall(){b.q.event.on(w.ce.soundUpdate,this._onSoundUpdate,this).on(f.qp.loadComplete,this._onLoadComplete,this).on(f.oo.drawStart,this._onLineDrawStart,this).on(f.TQ.ballVSlineContact,this._onBallVsLineContact,this).on(f.TQ.ballVSbrickContact,this._onBallVsBrickContact,this).on(f.TQ.ballVSbonusContact,this._onBallVsBonusContact,this).on(f.Is.playClick,this._playButton,this).on(f.a$.homeClick,this._playButton,this).on(f.a$.actionClick,this._playButton,this)}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){}onPause(){this._pauseAll()}onResume(){this._resumeAll()}onResize(t,e,i){}_onLineDrawStart(){this._play(Ii["line-draw"],{volume:.5})}_onBallVsLineContact(t,e){this._play(Ii["line-hit"],{volume:.8})}_onBallVsBrickContact(t,e,i){const{playerSet:s}=x.h.game.room,a=s.getFenceById(e).isCastle(i),n=s.player.fence.uuid===e,o="".concat(n?"player":"opponent","-").concat(a?"castle":"brick","-hit");this._play(Ii[o],{volume:.8})}_onBallVsBonusContact(t,e){this._play(Ii["opponent-castle-hit"],{volume:.8})}_playButton(){this._play(Ii.button,{volume:.3})}_playTheme(){Object.prototype.hasOwnProperty.call(Ii,"theme")&&this._fade(Ii.theme,{from:0,to:.1,duration:1,kill:!1},{loop:!0,volume:1})}_play(t,e){var i,s;const a=this._sounds[t];return a.loop(null!==(i=null==e?void 0:e.loop)&&void 0!==i&&i),a.volume(null!==(s=null==e?void 0:e.volume)&&void 0!==s?s:1),a.play(),a}_fade(t,e,i){const s=this._play(t,i),{from:a=0,to:n=s.volume(),duration:o=1,kill:r=!1}=e;return s.fade(a,n,1e3*o),r&&s.once("fade",(()=>s.stop())),s}}i(4122);i(9218);class Vi{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,y.Z)(this,"priority",void 0),(0,y.Z)(this,"next",null),(0,y.Z)(this,"previous",null),(0,y.Z)(this,"_fn",void 0),(0,y.Z)(this,"_context",void 0),(0,y.Z)(this,"_once",void 0),(0,y.Z)(this,"_destroyed",!1),this._fn=t,this._context=e,this.priority=i,this._once=s}match(t,e){return this._fn===t&&this._context===e}emit(t){var e;null!=this._fn&&(this._context?this._fn.call(this._context,t):null===(e=this._fn)||void 0===e||e.call(this,t));const i=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(t){this.previous=t,null!=t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this._fn=null,this._context=void 0,null!=this.previous&&(this.previous.next=this.next),null!=this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Hi=.06;class Gi{constructor(t){(0,y.Z)(this,"_delay",void 0),(0,y.Z)(this,"_completeHandler",void 0),(0,y.Z)(this,"update",(t=>{const e=t/Hi;var i;(this.config.delay-=e,this.config.delay<=0)&&(this.config.delay=0,null===(i=this._completeHandler)||void 0===i||i.call(this,this))})),this.config=t,this._delay=t.delay}get delay(){return this._delay}get elapsed(){return this.config.delay}get remaining(){return this._delay-this.elapsed}get repeatCount(){return this.config.repeat}reset(){this.config.delay=this._delay}repeat(){--this.config.repeat,this.reset()}onComplete(t,e){this._completeHandler=t.bind(e)}destroy(){this._completeHandler=void 0}}class ji{constructor(){(0,y.Z)(this,"autoStart",!1),(0,y.Z)(this,"deltaTime",1),(0,y.Z)(this,"deltaMS",void 0),(0,y.Z)(this,"elapsedMS",void 0),(0,y.Z)(this,"lastTime",-1),(0,y.Z)(this,"speed",1),(0,y.Z)(this,"started",!1),(0,y.Z)(this,"_head",void 0),(0,y.Z)(this,"_requestId",null),(0,y.Z)(this,"_maxElapsedMS",100),(0,y.Z)(this,"_minElapsedMS",0),(0,y.Z)(this,"_protected",!1),(0,y.Z)(this,"_lastFrame",-1),(0,y.Z)(this,"_tick",void 0),(0,y.Z)(this,"_onTickerTaskComplete",(t=>{const{callback:e,context:i,args:s,loop:a,repeat:n}=t.config;e.apply(i,s),n?t.repeat():a?t.reset():this.cancel(t)})),this._head=new Vi(null,null,1/0),this.deltaMS=1/Hi,this.elapsedMS=1/Hi,this._tick=t=>{this._requestId=null,this.started&&(this._update(t),this.started&&null===this._requestId&&null!=this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Hi);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;null!=(e=e.next);)t+=1;return t}add(t,e){return this._addListener(new Vi(t,e,0))}remove(t,e){let i=this._head.next;for(;null!=i;)i=i.match(t,e)?i.destroy():i.next;return null==this._head.next&&this._cancelIfNeeded(),this}post(t,e){return this._addListener(new Vi(t,e,0,!0))}delay(t){return this._createTask(t)}cancel(t){this.remove(t.update,this),t.destroy()}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;null!=t;)t=t.destroy(!0);this._head.destroy()}}_requestIfNeeded(){null===this._requestId&&null!=this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}_addListener(t){let e=this._head.next,i=this._head;if(null==e)t.connect(i);else{for(;null!=e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}null==t.previous&&t.connect(i)}return this._startIfPossible(),this}_createTask(t){const e=new Gi(t);return e.onComplete(this._onTickerTaskComplete,this),this.add(e.update,this),e}_update(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Hi;const i=this._head;let s=i.next;for(;null!=s;)s=s.emit(this.deltaTime);null==i.next&&this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}}class Ni{constructor(t){(0,y.Z)(this,"_ticker",void 0),(0,y.Z)(this,"_update",(()=>{const{lastTime:t,deltaMS:e}=this._ticker;this._app.update(t,e)})),this._app=t,this._ticker=new ji}get deltaMS(){return this._ticker.deltaMS}get lastTime(){return this._ticker.lastTime}post(t,e){this._ticker.post(t,e)}delay(t){return this._ticker.delay(t)}cancel(t){this._ticker.cancel(t)}add(t,e){this._ticker.add(t,e)}remove(t,e){this._ticker.remove(t,e)}async onInstall(){this._ticker.add(this._update,this),this._ticker.maxFPS=70,this._ticker.start()}onUninstall(){}onPluginInstall(t){}onPluginUninstall(t){}onUpdate(t,e){}onPause(){this._ticker.stop()}onResume(){this._ticker.start()}onResize(t,e,i){}}var Wi,Ji,Xi,$i=i(1271),Yi=i(6370),Qi=i(863),Ki=function(){return Wi||"undefined"!=typeof window&&(Wi=window.gsap)&&Wi.registerPlugin&&Wi},ts={easeOut:"M0,1,C0.7,1,0.6,0,1,0",easeInOut:"M0,0,C0.1,0,0.24,1,0.444,1,0.644,1,0.6,0,1,0",anticipate:"M0,0,C0,0.222,0.024,0.386,0,0.4,0.18,0.455,0.65,0.646,0.7,0.67,0.9,0.76,1,0.846,1,1",uniform:"M0,0,C0,0.95,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0"},es=function(t){return t},is=function(t){if(!Ji&&(Wi=Ki(),Xi=Wi&&Wi.parseEase("_CE"))){for(var e in ts)ts[e]=Xi("",ts[e]);Ji=1,as("wiggle").config=function(t){return"object"==typeof t?as("",t):as("wiggle("+t+")",{wiggles:+t})}}},ss=function(t,e){return"function"!=typeof t&&(t=Wi.parseEase(t)||Xi("",t)),t.custom||!e?t:function(e){return 1-t(e)}},as=function(t,e){Ji||is();var i,s,a,n,o,r,h,l,d,c=0|((e=e||{}).wiggles||10),_=1/c,u=_/2,p="anticipate"===e.type,g=ts[e.type]||ts.easeOut,m=es;if(p&&(m=g,g=ts.easeOut),e.timingEase&&(m=ss(e.timingEase)),e.amplitudeEase&&(g=ss(e.amplitudeEase,!0)),l=[0,0,(r=m(u))/4,0,r/2,h=p?-g(u):g(u),r,h],"random"===e.type){for(l.length=4,i=m(_),s=2*Math.random()-1,d=2;d<c;d++)u=i,h=s,i=m(_*d),s=2*Math.random()-1,a=Math.atan2(s-l[l.length-3],i-l[l.length-4]),n=Math.cos(a)*_,o=Math.sin(a)*_,l.push(u-n,h-o,u,h,u+n,h+o);l.push(i,0,1,0)}else{for(d=1;d<c;d++)l.push(m(u+_/2),h),u+=_,h=(h>0?-1:1)*g(d*_),r=m(u),l.push(m(u-_/2),h,r,h);l.push(m(u+_/4),h,m(u+_/4),0,1,0)}for(d=l.length;--d>-1;)l[d]=~~(1e3*l[d])/1e3;return l[2]="C"+l[2],Xi(t,"M"+l.join(","))},ns=function(){function t(t,e){this.ease=as(t,e)}return t.create=function(t,e){return as(t,e)},t.register=function(t){Wi=t,is()},t}();function os(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function rs(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?os(Object(i),!0).forEach((function(e){(0,y.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):os(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}Ki()&&Wi.registerPlugin(ns),ns.version="3.9.1";class hs{constructor(t){this._app=t}async onInstall(){$i.ZP.registerPlugin(Yi.w),$i.ZP.registerPlugin({name:"universal",init:()=>{}}),$i.ZP.defaults({ease:Tt.bJ.easeNone}),$i.ZP.registerPlugin(Qi.t,ns),ns.create("shake",{wiggles:8,type:"easeInOut"})}onUninstall(){}onUpdate(t,e){}onPluginInstall(t){(async()=>{if(t===s.J0.pixi){const t=await Promise.resolve().then(i.bind(i,513)),e=await Promise.resolve().then(i.bind(i,2207));Yi.w.registerPIXI(rs(rs({},t),e))}})()}onPluginUninstall(t){}onPause(){$i.ZP.ticker.sleep()}onResume(){$i.ZP.ticker.wake()}onResize(t,e,i){$i.ZP.globalTimeline.getChildren().filter((t=>!(!0===t.vars.universal||null!=t.parent&&!0===t.parent.vars.universal))).forEach((t=>{t.totalProgress(!0===t.vars.yoyo?0:1,!1),t.kill()}))}}const ls=async()=>{await a.l2.installPlugin(s.J0.screen,new zi(a.l2)),await a.l2.installPlugin(s.J0.loader,new D(a.l2)),await a.l2.installPlugin(s.J0.ticker,new Ni(a.l2)),await a.l2.installPlugin(s.J0.localization,new R(a.l2)),await a.l2.installPlugin(s.J0.sound,new qi(a.l2)),await a.l2.installPlugin(s.J0.haptic,new S(a.l2)),await a.l2.installPlugin(s.J0.tween,new hs(a.l2)),await a.l2.installPlugin(s.J0.physics2D,new $(a.l2)),await a.l2.installPlugin(s.J0.pixi,new Ui(a.l2))}},9728:function(t){t.exports=JSON.parse('{"autoUpdate":true,"emit":false,"lifetime":{"min":0.5,"max":0.5},"frequency":0.001,"spawnChance":1,"particlesPerWave":1,"emitterLifetime":0.1,"maxParticles":10,"pos":{"x":0,"y":0},"addAtBack":false,"behaviors":[{"type":"alpha","config":{"alpha":{"list":[{"value":1,"time":0},{"value":0,"time":1}]}}},{"type":"scale","config":{"scale":{"list":[{"value":1,"time":0},{"value":0.1,"time":1}]}}},{"type":"moveSpeed","config":{"speed":{"list":[{"value":100,"time":0},{"value":180,"time":1}],"isStepped":false}}},{"type":"color","config":{"color":{"list":[{"time":0,"value":"cdcdcd"},{"time":1,"value":"cecece"}]}}},{"type":"rotationStatic","config":{"min":0,"max":360}},{"type":"spawnShape","config":{"type":"rect","data":{"x":-55,"y":-55,"w":110,"h":110}}},{"type":"textureRandom","config":{"textures":["brick-part-01.png","brick-part-02.png","brick-part-03.png","brick-part-04.png","brick-part-05.png","brick-part-06.png","brick-part-07.png","brick-part-08.png","brick-part-09.png","brick-part-10.png"]}}]}')},737:function(t){t.exports=JSON.parse('{"lifetime":{"min":0.2,"max":0.3},"frequency":0.01,"emitterLifetime":-1,"maxParticles":40,"addAtBack":true,"pos":{"x":0,"y":0},"emit":false,"autoUpdate":false,"behaviors":[{"type":"alpha","config":{"alpha":{"list":[{"time":0,"value":1},{"time":1,"value":0}]}}},{"type":"moveSpeed","config":{"speed":{"list":[{"time":0,"value":10},{"time":1,"value":5}]},"minMult":1}},{"type":"scale","config":{"scale":{"list":[{"time":0,"value":1},{"time":1,"value":0.1}]},"minMult":1}},{"type":"colorStatic","config":{"color":"#ffffff"}},{"type":"rotationStatic","config":{"min":0,"max":360}},{"type":"textureRandom","config":{"textures":["fire-trail.png","fire-ball.png"]}},{"type":"spawnShape","config":{"type":"circle","data":{"x":0,"y":0,"radius":0}}}]}')},5143:function(t){t.exports=JSON.parse('{"autoUpdate":true,"emit":false,"lifetime":{"min":0.4,"max":0.4},"frequency":0,"spawnChance":1,"particlesPerWave":1,"emitterLifetime":0.1,"maxParticles":50,"pos":{"x":0,"y":0},"addAtBack":false,"behaviors":[{"type":"alpha","config":{"alpha":{"list":[{"value":0.4,"time":0},{"value":0.1,"time":1}]}}},{"type":"scale","config":{"scale":{"list":[{"value":0.5,"time":0},{"value":0.1,"time":1}]}}},{"type":"color","config":{"color":{"list":[{"value":"000000","time":0},{"value":"000001","time":1}]}}},{"type":"moveSpeed","config":{"speed":{"list":[{"value":50,"time":0},{"value":40,"time":1}],"isStepped":false}}},{"type":"rotationStatic","config":{"min":0,"max":360}},{"type":"spawnShape","config":{"type":"rect","data":{"x":0,"y":0,"w":0,"h":0}}},{"type":"textureSingle","config":{"texture":"snow-particle.png"}}]}')}}]);